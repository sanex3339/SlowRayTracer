(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.TraceWorker = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var Vector_1=require("./Vector"),Camera=function(){function t(t,r,e,o){this.position=t,this.direction=Vector_1.Vector.normalized(r),this.screenWidth=e,this.screenHeight=o,this.forwardVector=Vector_1.Vector.normalized(Vector_1.Vector.substract(this.direction,this.position)),this.rightVector=Vector_1.Vector.scaled(Vector_1.Vector.normalized(Vector_1.Vector.cross(this.forwardVector,new Vector_1.Vector(0,-1,0))),3),this.upVector=Vector_1.Vector.scaled(Vector_1.Vector.normalized(Vector_1.Vector.cross(this.forwardVector,this.rightVector)),3)}return t.prototype.getDirection=function(){return this.direction},t.prototype.getPosition=function(){return this.position},t.prototype.getForwardVector=function(){return this.forwardVector},t.prototype.getRightVector=function(){return this.rightVector},t.prototype.getUpVector=function(){return this.upVector},t.prototype.recenterX=function(t){var r=this.screenHeight/this.screenWidth*2;return(t-this.screenWidth/2)/r/this.screenWidth},t.prototype.recenterY=function(t){return-(t-this.screenHeight/2)/2/this.screenHeight},t}();exports.Camera=Camera;


},{"./Vector":15}],2:[function(require,module,exports){
var FloatColor_1=require("./FloatColor"),Color=function(){function o(o){this.red=o.red,this.green=o.green,this.blue=o.blue}return o.prototype.add=function(e){return new o(new FloatColor_1.FloatColor(this.red+e.red,this.green+e.green,this.blue+e.blue))},o.prototype.substract=function(e){return new o(new FloatColor_1.FloatColor(this.red-e.red,this.green-e.green,this.blue-e.blue))},o.prototype.scaled=function(e){return new o(new FloatColor_1.FloatColor(this.red*e,this.green*e,this.blue*e))},o.prototype.multiple=function(e){return new o(new FloatColor_1.FloatColor(this.red*e.red,this.green*e.green,this.blue*e.blue))},o.prototype.divide=function(e){return new o(new FloatColor_1.FloatColor(this.red/e,this.green/e,this.blue/e))},o.sRGBEncode=function(o){return.0031308>=o?12.92*o:1.055*Math.pow(o,.4166667)-.055},o.toRGB=function(e){return{red:Math.floor(255*o.clampColor(e.red)),green:Math.floor(255*o.clampColor(e.green)),blue:Math.floor(255*o.clampColor(e.blue))}},o.clampColor=function(o){return o>1?1:o},o}();exports.Color=Color;


},{"./FloatColor":3}],3:[function(require,module,exports){
var FloatColor=function(){function o(o,t,r){this.red=o,this.green=t,this.blue=r}return o}();exports.FloatColor=FloatColor;


},{}],4:[function(require,module,exports){
var RGBColor=function(){function o(t,r,n){this.red=o.toFloat(t),this.green=o.toFloat(r),this.blue=o.toFloat(n)}return o.toFloat=function(o){return 0===o?o:o/255},o}();exports.RGBColor=RGBColor;


},{}],5:[function(require,module,exports){
var AbstractLight=function(){function t(){}return t}();exports.AbstractLight=AbstractLight;


},{}],6:[function(require,module,exports){
var __extends=this&&this.__extends||function(t,r){function e(){this.constructor=t}for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o]);t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)},AbstractLight_1=require("./AbstractLight"),Color_1=require("./../Color/Color"),Material_1=require("./../Material"),RGBColor_1=require("./../Color/RGBColor"),RTMath_1=require("./../RTMath"),Vector_1=require("./../Vector"),SphericalLight=function(t){function r(r,e,o){t.call(this),this.radius=50,this.fadeRadius=2500,this.material=new Material_1.Material(new Color_1.Color(new RGBColor_1.RGBColor(244,244,244)),0).setLambertCoeff(1),this.type="light",this.position=r,this.power=e,o&&(this.radius=o)}return __extends(r,t),r.prototype.getFadeRadius=function(){return this.radius+this.fadeRadius},r.prototype.getPosition=function(){return this.position},r.prototype.getPower=function(){return this.power},r.prototype.getRadius=function(){return this.radius},r.prototype.getRandomPoint=function(){var t=Math.random(),r=Math.random(),e=2*Math.PI*t,o=Math.pow(Math.cos(2*r-1),-1);return new Vector_1.Vector(this.radius*Math.cos(e)*Math.sin(o),this.radius*Math.sin(e)*Math.sin(o),this.radius*Math.cos(o))},r.prototype.getIntersectData=function(t){var r,e,o,i,a,s,n,h=Vector_1.Vector.substract(t.getOrigin(),this.position),c=Vector_1.Vector.dot(h,t.getDirection()),u=Vector_1.Vector.dot(h,h)-Math.pow(this.radius,2),p=Math.pow(c,2)-u;if(!(c>0||0>p||p>=0&&(r=-c+Math.sqrt(p),e=-c-Math.sqrt(p),o=Math.min(r,e),i=Math.max(r,e),a=o>RTMath_1.RTMath.EPSILON?o:i,a<RTMath_1.RTMath.EPSILON)))return s=Vector_1.Vector.add(Vector_1.Vector.scaled(t.getDirection(),a),t.getOrigin()),n=Vector_1.Vector.substract(s,t.getOrigin()).getLength(),{point:s,distance:n}},r.prototype.getNormal=function(t){return Vector_1.Vector.normalized(Vector_1.Vector.scaled(Vector_1.Vector.substract(t,this.position),1/this.radius))},r.prototype.getMaterial=function(){return this.material},r.prototype.getType=function(){return this.type},r.prototype.setMaterial=function(t){return this.material=t,this},r}(AbstractLight_1.AbstractLight);exports.SphericalLight=SphericalLight;


},{"./../Color/Color":2,"./../Color/RGBColor":4,"./../Material":7,"./../RTMath":11,"./../Vector":15,"./AbstractLight":5}],7:[function(require,module,exports){
var Color_1=require("./Color/Color"),RGBColor_1=require("./Color/RGBColor"),Material=function(){function o(o,t){void 0===o&&(o=new Color_1.Color(new RGBColor_1.RGBColor(255,0,0))),void 0===t&&(t=0),this.lambertCoeff=.5,this.phongCoeff=.5,this.reflectionCoeff=0,this.color=o,this.reflectionCoeff=t}return o.prototype.getColor=function(){return this.color},o.prototype.getLambertCoeff=function(){return this.lambertCoeff},o.prototype.getPhongCoeff=function(){return this.phongCoeff},o.prototype.getReflectionValue=function(){return this.reflectionCoeff},o.prototype.setLambertCoeff=function(o){return this.lambertCoeff=o,this.phongCoeff=1-o,this},o.prototype.setPhongCoeff=function(o){return this.phongCoeff=o,this.lambertCoeff=1-o,this},o}();exports.Material=Material;


},{"./Color/Color":2,"./Color/RGBColor":4}],8:[function(require,module,exports){
var AbstractObject=function(){function t(){}return t}();exports.AbstractObject=AbstractObject;


},{}],9:[function(require,module,exports){
var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},RTMath_1=require("../RTMath"),AbstractObject_1=require("./AbstractObject"),Color_1=require("../Color/Color"),Material_1=require("../Material"),RGBColor_1=require("../Color/RGBColor"),Vector_1=require("../Vector"),Polygon=function(t){function e(){for(var e=[],r=0;r<arguments.length;r++)e[r-0]=arguments[r];t.call(this),this.material=new Material_1.Material(new Color_1.Color(new RGBColor_1.RGBColor(115,115,115)),0),this.type="surface",this.vertices=e}return __extends(e,t),e.prototype.getIntersectData=function(t){var r,o,c,i,s,n=this.getNormal();if(o=Vector_1.Vector.dot(this.vertices[0],n),s=Vector_1.Vector.dot(n,t.getDirection()),i=-Vector_1.Vector.dot(n,t.getOrigin())+o,r=i/s,!(r<RTMath_1.RTMath.EPSILON)){t.setDistance(r),c=t.getHitPoint();for(var a=0,l=this.vertices.length;l>a;a++){var u=this.vertices[a],h=void 0;if(h=a===l-1?this.vertices[0]:this.vertices[a+1],!e.checkSameClockDir(Vector_1.Vector.substract(h,u),Vector_1.Vector.substract(c,u),this.getNormal()))return}return r=Vector_1.Vector.substract(c,t.getOrigin()).getLength(),{point:c,distance:r}}},e.prototype.getMaterial=function(){return this.material},e.prototype.getNormal=function(){var t=Vector_1.Vector.substract(this.vertices[2],this.vertices[0]),e=Vector_1.Vector.substract(this.vertices[1],this.vertices[0]);return Vector_1.Vector.normalized(Vector_1.Vector.cross(t,e))},e.prototype.getType=function(){return this.type},e.prototype.setMaterial=function(t){return this.material=t,this},e.checkSameClockDir=function(t,e,r){var o=Vector_1.Vector.cross(e,t);return Vector_1.Vector.dot(o,r)>=0},e}(AbstractObject_1.AbstractObject);exports.Polygon=Polygon;


},{"../Color/Color":2,"../Color/RGBColor":4,"../Material":7,"../RTMath":11,"../Vector":15,"./AbstractObject":8}],10:[function(require,module,exports){
var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},RTMath_1=require("../RTMath"),AbstractObject_1=require("./AbstractObject"),Color_1=require("../Color/Color"),Material_1=require("../Material"),RGBColor_1=require("../Color/RGBColor"),Vector_1=require("../Vector"),Sphere=function(t){function e(e,r){t.call(this),this.material=new Material_1.Material(new Color_1.Color(new RGBColor_1.RGBColor(255,0,0)),0),this.type="surface",this.center=e,this.radius=r}return __extends(e,t),e.prototype.getIntersectData=function(t){var e,r,o,i,a,c,n,s=Vector_1.Vector.substract(t.getOrigin(),this.center),h=Vector_1.Vector.dot(s,t.getDirection()),u=Vector_1.Vector.dot(s,s)-Math.pow(this.radius,2),l=Math.pow(h,2)-u;if(!(h>0||0>l||l>=0&&(e=-h+Math.sqrt(l),r=-h-Math.sqrt(l),o=Math.min(e,r),i=Math.max(e,r),a=o>RTMath_1.RTMath.EPSILON?o:i,a<RTMath_1.RTMath.EPSILON)))return c=Vector_1.Vector.add(Vector_1.Vector.scaled(t.getDirection(),a),t.getOrigin()),n=Vector_1.Vector.substract(c,t.getOrigin()).getLength(),{point:c,distance:n}},e.prototype.getMaterial=function(){return this.material},e.prototype.getNormal=function(t){return Vector_1.Vector.normalized(Vector_1.Vector.scaled(Vector_1.Vector.substract(t,this.center),1/this.radius))},e.prototype.getType=function(){return this.type},e.prototype.setMaterial=function(t){return this.material=t,this},e}(AbstractObject_1.AbstractObject);exports.Sphere=Sphere;


},{"../Color/Color":2,"../Color/RGBColor":4,"../Material":7,"../RTMath":11,"../Vector":15,"./AbstractObject":8}],11:[function(require,module,exports){
var RTMath;!function(t){t.EPSILON=.001}(RTMath=exports.RTMath||(exports.RTMath={}));


},{}],12:[function(require,module,exports){
var Vector_1=require("./Vector"),Ray=function(){function t(t,i,e){this.distance=0,this.iteration=8,this.origin=t,this.direction=Vector_1.Vector.normalized(i),e&&(this.iteration=e)}return t.prototype.getDirection=function(){return this.direction},t.prototype.getDistance=function(){return this.distance},t.prototype.getIteration=function(){return this.iteration},t.prototype.getOrigin=function(){return this.origin},t.prototype.getHitPoint=function(){return Vector_1.Vector.add(this.origin,Vector_1.Vector.scaled(this.direction,this.distance))},t.prototype.setDistance=function(t){this.distance=t},t.prototype.setIteration=function(t){this.iteration=t},t}();exports.Ray=Ray;


},{"./Vector":15}],13:[function(require,module,exports){
var Scene=function(){function t(t){this.objects=[],this.lights=[],this.objects=t.objects,this.camera=t.camera,this.lights=t.lights}return t.prototype.addObject=function(t){this.objects.push(t)},t.prototype.getCamera=function(){return this.camera},t.prototype.getLights=function(){return this.lights},t.prototype.getObjects=function(){return this.objects},t}();exports.Scene=Scene;


},{}],14:[function(require,module,exports){
var Camera_1=require("./Camera"),Color_1=require("./Color/Color"),Ray_1=require("./Ray"),RGBColor_1=require("./Color/RGBColor"),Scene_1=require("./Scene"),Sphere_1=require("./Objects/Sphere"),Vector_1=require("./Vector"),SphericalLight_1=require("./Lights/SphericalLight"),Material_1=require("./Material"),Polygon_1=require("./Objects/Polygon"),Tracer=function(){function e(){this.pixelSamples=4,this.shadowSamples=35,this.aoSamples=100,this.giSamples=35,this.screenWidth=250,this.screenHeight=250}return e.prototype.getColor=function(e,o){void 0===o&&(o=!0);var t=this.trace(e),r=new Color_1.Color(new RGBColor_1.RGBColor(0,0,0)),a=new Color_1.Color(new RGBColor_1.RGBColor(0,0,0));return null===t.owner?new Color_1.Color(new RGBColor_1.RGBColor(0,0,0)):(r=this.getDiffuseColor(e,t,o),o&&(a=this.getReflectionColor(e,t)),r.add(a))},e.prototype.getDiffuseColor=function(e,o,t){void 0===t&&(t=!0);for(var r,a,n,l,i,c,s,C,_,w,V,g=new Color_1.Color(new RGBColor_1.RGBColor(0,0,0)),d=0,h=this.scene.getLights();d<h.length;d++){var p=h[d];if("light"===o.ownerType)return o.owner.getMaterial().getColor();s=this.getLightPower(o,p),r=new Color_1.Color(new RGBColor_1.RGBColor(0,0,0)),a=new Color_1.Color(new RGBColor_1.RGBColor(0,0,0)),n=new Color_1.Color(new RGBColor_1.RGBColor(0,0,0)),i=new Color_1.Color(new RGBColor_1.RGBColor(0,0,0)),c=Vector_1.Vector.normalized(Vector_1.Vector.substract(o.point,p.getPosition())),_=-Vector_1.Vector.dot(c,o.normal),r=r.add(o.owner.getMaterial().getColor().multiple(p.getMaterial().getColor().scaled(s*_*o.owner.getMaterial().getLambertCoeff())));var M=function(e){var o=Math.random(),t=Math.random(),r=Math.acos(Math.sqrt(1-o)),a=2*Math.PI*t,n=Math.sin(r)*Math.cos(a),l=Math.cos(r),i=Math.sin(r)*Math.sin(a),c=e,s=e;s=Math.abs(s.getCoordinates().x)<=Math.abs(s.getCoordinates().y)&&Math.abs(s.getCoordinates().x)<=Math.abs(s.getCoordinates().z)?new Vector_1.Vector(1,s.getCoordinates().y,s.getCoordinates().z):Math.abs(s.getCoordinates().y)<=Math.abs(s.getCoordinates().x)&&Math.abs(s.getCoordinates().x)<=Math.abs(s.getCoordinates().z)?new Vector_1.Vector(s.getCoordinates().x,1,s.getCoordinates().z):new Vector_1.Vector(s.getCoordinates().x,s.getCoordinates().y,1);var C=Vector_1.Vector.normalized(new Vector_1.Vector(Math.pow(s.getCoordinates().x,c.getCoordinates().x),Math.pow(s.getCoordinates().y,c.getCoordinates().y),Math.pow(s.getCoordinates().z,c.getCoordinates().z))),_=Vector_1.Vector.normalized(new Vector_1.Vector(Math.pow(C.getCoordinates().x,c.getCoordinates().x),Math.pow(C.getCoordinates().y,c.getCoordinates().y),Math.pow(C.getCoordinates().z,c.getCoordinates().z))),w=Vector_1.Vector.add(Vector_1.Vector.add(Vector_1.Vector.scaled(C,n),Vector_1.Vector.scaled(c,l)),Vector_1.Vector.scaled(_,i));return Vector_1.Vector.normalized(w)};if(t)for(var R=0;R<this.giSamples;++R){var u=void 0,m=void 0;l=M(o.owner.getNormal(o.point)),u=this.getColor(new Ray_1.Ray(o.point,l),!1),m=Vector_1.Vector.dot(l,o.owner.getNormal(o.point)),a=a.add(o.owner.getMaterial().getColor().divide(Math.PI).multiple(u.scaled(m)))}for(var f=0,R=0;R<this.aoSamples;R++){var y=M(o.owner.getNormal(o.point)),B=this.trace(new Ray_1.Ray(o.point,y));null!==B.point&&(B.distance>250||f++)}C=Vector_1.Vector.reflect(c,o.normal),w=-Vector_1.Vector.dot(C,e.getDirection()),w>0&&(V=Math.pow(w,35),i=i.add(o.owner.getMaterial().getColor().multiple(p.getMaterial().getColor().scaled(s*V*o.owner.getMaterial().getPhongCoeff())))),g=g.add(r.add(a.divide(this.giSamples))).add(i),g=g.substract(g.scaled(.3*f/this.aoSamples))}return g},e.prototype.getReflectionColor=function(e,o){var t,r,a=e.getIteration(),n=o.owner.getMaterial().getReflectionValue();return e.setIteration(--a),0===a||0===n?new Color_1.Color(new RGBColor_1.RGBColor(0,0,0)):(r=Vector_1.Vector.reflect(e.getDirection(),o.normal),t=this.getColor(new Ray_1.Ray(o.point,r,a)).scaled(n))},e.prototype.getPerspectiveVector=function(e,o){var t=this.scene.getCamera();return Vector_1.Vector.normalized(Vector_1.Vector.add(t.getForwardVector(),Vector_1.Vector.add(Vector_1.Vector.scaled(t.getRightVector(),t.recenterX(e)),Vector_1.Vector.scaled(t.getUpVector(),t.recenterY(o)))))},e.prototype.getLightPower=function(e,o){for(var t,r,a=o.getPower(),n=0,l=0;l<this.shadowSamples;l++)t=o.getRandomPoint(),r=this.trace(new Ray_1.Ray(e.point,Vector_1.Vector.substract(Vector_1.Vector.substract(o.getPosition(),t),e.point))),null!==r.point&&r.owner===o&&(n+=(a-Vector_1.Vector.substract(Vector_1.Vector.substract(o.getPosition(),t),e.point).getLength()*(a/o.getFadeRadius()))/this.shadowSamples);return n},e.prototype.trace=function(e){for(var o,t={distance:0,point:null,normal:null,owner:null,ownerType:null},r=this.scene.getObjects().concat(this.scene.getLights()),a=0,n=r;a<n.length;a++){var l=n[a];o=l.getIntersectData(e),o&&o.distance>0&&(null===t.owner||o.distance<t.distance)&&(t.distance=o.distance,t.point=o.point,t.owner=l,t.ownerType=l.getType(),t.normal=t.owner.getNormal(t.point))}return t},e.prototype.render=function(e,o,t,r){var a,n,l,i,c=.5;this.screenWidth=e,this.screenHeight=o,a=new Color_1.Color(new RGBColor_1.RGBColor(0,0,0));for(var s=0;s<this.pixelSamples;s++)n=0,this.pixelSamples>1&&(s%2?n+=Math.random()*c:n-=Math.random()*c),l=new Ray_1.Ray(this.scene.getCamera().getPosition(),this.getPerspectiveVector(t+n,r+n)),a=a.add(this.getColor(l));a=a.divide(this.pixelSamples);for(var C in a)a[C]=Color_1.Color.sRGBEncode(a[C]);i=Color_1.Color.toRGB(a),self.postMessage([t,r,i.red,i.green,i.blue])},e.prototype.setScene=function(e){this.scene=e},e}();onmessage=function(e){var o=e.data;"string"==typeof o&&(o=JSON.parse("["+o+"]"));var t=new Tracer;t.setScene(new Scene_1.Scene({camera:new Camera_1.Camera(new Vector_1.Vector(0,0,-699),new Vector_1.Vector(0,0,1),o[0],o[1]),lights:[new SphericalLight_1.SphericalLight(new Vector_1.Vector(0,640,0),.7,50).setMaterial(new Material_1.Material(new Color_1.Color(new RGBColor_1.RGBColor(255,255,255)))),new SphericalLight_1.SphericalLight(new Vector_1.Vector(0,0,0),.7,150).setMaterial(new Material_1.Material(new Color_1.Color(new RGBColor_1.RGBColor(255,235,200))))],objects:[new Polygon_1.Polygon(new Vector_1.Vector(-700,-700,-700),new Vector_1.Vector(700,-700,-700),new Vector_1.Vector(700,-700,700),new Vector_1.Vector(-700,-700,700)).setMaterial(new Material_1.Material(new Color_1.Color(new RGBColor_1.RGBColor(255,255,255)),0).setLambertCoeff(1)),new Polygon_1.Polygon(new Vector_1.Vector(-700,-700,700),new Vector_1.Vector(700,-700,700),new Vector_1.Vector(700,700,700),new Vector_1.Vector(-700,700,700)).setMaterial(new Material_1.Material(new Color_1.Color(new RGBColor_1.RGBColor(255,255,255)),0).setLambertCoeff(1)),new Polygon_1.Polygon(new Vector_1.Vector(-700,700,-700),new Vector_1.Vector(-700,700,700),new Vector_1.Vector(700,700,700),new Vector_1.Vector(700,700,-700)).setMaterial(new Material_1.Material(new Color_1.Color(new RGBColor_1.RGBColor(255,255,255)),0).setLambertCoeff(1)),new Polygon_1.Polygon(new Vector_1.Vector(700,-700,700),new Vector_1.Vector(700,-700,-700),new Vector_1.Vector(700,700,-700),new Vector_1.Vector(700,700,700)).setMaterial(new Material_1.Material(new Color_1.Color(new RGBColor_1.RGBColor(79,166,242)),0).setLambertCoeff(1)),new Polygon_1.Polygon(new Vector_1.Vector(-700,-700,-700),new Vector_1.Vector(-700,-700,700),new Vector_1.Vector(-700,700,700),new Vector_1.Vector(-700,700,-700)).setMaterial(new Material_1.Material(new Color_1.Color(new RGBColor_1.RGBColor(245,130,130)),0).setLambertCoeff(1)),new Polygon_1.Polygon(new Vector_1.Vector(700,-700,-700),new Vector_1.Vector(-700,-700,-700),new Vector_1.Vector(-700,700,-700),new Vector_1.Vector(700,700,-700)).setMaterial(new Material_1.Material(new Color_1.Color(new RGBColor_1.RGBColor(0,0,0)),0).setLambertCoeff(1)),new Sphere_1.Sphere(new Vector_1.Vector(-250,-500,450),200).setMaterial(new Material_1.Material(new Color_1.Color(new RGBColor_1.RGBColor(0,0,0)),1)),new Sphere_1.Sphere(new Vector_1.Vector(250,-500,400),200).setMaterial(new Material_1.Material(new Color_1.Color(new RGBColor_1.RGBColor(0,255,0)),0))]})),t.render(o[0],o[1],o[2],o[3])};


},{"./Camera":1,"./Color/Color":2,"./Color/RGBColor":4,"./Lights/SphericalLight":6,"./Material":7,"./Objects/Polygon":9,"./Objects/Sphere":10,"./Ray":12,"./Scene":13,"./Vector":15}],15:[function(require,module,exports){
var Vector=function(){function t(t,n,r){this.x=t,this.y=n,this.z=r}return t.prototype.getCoordinates=function(){return{x:this.x,y:this.y,z:this.z}},t.prototype.asArray=function(){return[this.x,this.y,this.z]},t.prototype.getLength=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2))},t.add=function(n,r){return new t(n.x+r.x,n.y+r.y,n.z+r.z)},t.substract=function(n,r){return new t(n.x-r.x,n.y-r.y,n.z-r.z)},t.scaled=function(n,r){return new t(n.x*r,n.y*r,n.z*r)},t.cross=function(n,r){return new t(n.y*r.z-n.z*r.y,n.z*r.x-n.x*r.z,n.x*r.y-n.y*r.x)},t.inverse=function(n){return t.scaled(n,-1)},t.dot=function(t,n){return t.x*n.x+t.y*n.y+t.z*n.z},t.normalized=function(n){return t.scaled(n,1/n.getLength())},t.reflect=function(n,r){var e=2*t.dot(n,r);return t.substract(n,t.scaled(r,e))},t}();exports.Vector=Vector;


},{}]},{},[14])(14)
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Vzci9saWIvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsIi9zb3VyY2UvQ2FtZXJhLnRzIiwiL3NvdXJjZS9Db2xvci9Db2xvci50cyIsIi9zb3VyY2UvQ29sb3IvRmxvYXRDb2xvci50cyIsIi9zb3VyY2UvQ29sb3IvUkdCQ29sb3IudHMiLCIvc291cmNlL0xpZ2h0cy9BYnN0cmFjdExpZ2h0LnRzIiwiL3NvdXJjZS9MaWdodHMvU3BoZXJpY2FsTGlnaHQuanMiLCIvc291cmNlL0xpZ2h0cy9TcGhlcmljYWxMaWdodC50cyIsIi9zb3VyY2UvTWF0ZXJpYWwudHMiLCIvc291cmNlL09iamVjdHMvQWJzdHJhY3RPYmplY3QudHMiLCIvc291cmNlL09iamVjdHMvUG9seWdvbi5qcyIsIi9zb3VyY2UvT2JqZWN0cy9Qb2x5Z29uLnRzIiwiL3NvdXJjZS9PYmplY3RzL1NwaGVyZS5qcyIsIi9zb3VyY2UvT2JqZWN0cy9TcGhlcmUudHMiLCIvc291cmNlL1JUTWF0aC50cyIsIi9zb3VyY2UvUmF5LnRzIiwiL3NvdXJjZS9TY2VuZS50cyIsIi9zb3VyY2UvVHJhY2VyV29ya2VyLnRzIiwiL3NvdXJjZS9WZWN0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQSxHQUFBLFVBQUEsUUFBdUIsWUFFdkIsT0FBQSxXQVNJLFFBQUEsR0FBYSxFQUFrQixFQUFtQixFQUFxQixHQUNuRSxLQUFLLFNBQVcsRUFDaEIsS0FBSyxVQUFZLFNBQUEsT0FBTyxXQUFXLEdBQ25DLEtBQUssWUFBYyxFQUNuQixLQUFLLGFBQWUsRUFFcEIsS0FBSyxjQUFnQixTQUFBLE9BQU8sV0FBVyxTQUFBLE9BQU8sVUFBVSxLQUFLLFVBQVcsS0FBSyxXQUM3RSxLQUFLLFlBQWMsU0FBQSxPQUFPLE9BQ3RCLFNBQUEsT0FBTyxXQUNILFNBQUEsT0FBTyxNQUNILEtBQUssY0FDTCxH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TSxHQUFJLFlBQUEsU0FBUyxJQUFLLElBQUssUUFDL0QsR0FBSSxrQkFBQSxlQUFlLEdBQUksVUFBQSxPQUFRLEVBQUcsRUFBRyxHQUFJLEdBQUssS0FDekMsWUFBWSxHQUFJLFlBQUEsU0FBUyxHQUFJLFNBQUEsTUFBTSxHQUFJLFlBQUEsU0FBUyxJQUFLLElBQUssU0FFbkUsU0FHSSxHQUFJLFdBQUEsUUFDQSxHQUFJLFVBQUEsT0FBTyxLQUFNLEtBQU0sTUFDdkIsR0FBSSxVQUFBLE9BQU8sSUFBSyxLQUFNLE1BQ3RCLEdBQUksVUFBQSxPQUFPLElBQUssS0FBTSxLQUN0QixHQUFJLFVBQUEsT0FBTyxLQUFNLEtBQU0sTUFDekIsWUFBWSxHQUFJLFlBQUEsU0FBUyxHQUFJLFNBQUEsTUFBTSxHQUFJLFlBQUEsU0FBUyxJQUFLLElBQUssTUFBTyxHQUFHLGdCQUFnQixJQUV0RixHQUFJLFdBQUEsUUFDQSxHQUFJLFVBQUEsT0FBTyxLQUFNLEtBQU0sS0FDdkIsR0FBSSxVQUFBLE9BQU8sSUFBSyxLQUFNLEtBQ3RCLEdBQUksVUFBQSxPQUFPLElBQUssSUFBSyxLQUNyQixHQUFJLFVBQUEsT0FBTyxLQUFNLElBQUssTUFDeEIsWUFBWSxHQUFJLFlBQUEsU0FBUyxHQUFJLFNBQUEsTUFBTSxHQUFJLFlBQUEsU0FBUyxJQUFLLElBQUssTUFBTyxHQUFHLGdCQUFnQixJQUV0RixHQUFJLFdBQUEsUUFDQSxHQUFJLFVBQUEsT0FBTyxLQUFNLElBQUssTUFDdEIsR0FBSSxVQUFBLE9BQU8sS0FBTSxJQUFLLEtBQ3RCLEdBQUksVUFBQSxPQUFPLElBQUssSUFBSyxLQUNyQixHQUFJLFVBQUEsT0FBTyxJQUFLLElBQUssT0FDdkIsWUFBWSxHQUFJLFlBQUEsU0FBUyxHQUFJLFNBQUEsTUFBTSxHQUFJLFlBQUEsU0FBUyxJQUFLLElBQUssTUFBTyxHQUFHLGdCQUFnQixJQUV0RixHQUFJLFdBQUEsUUFDQSxHQUFJLFVBQUEsT0FBTyxJQUFLLEtBQU0sS0FDdEIsR0FBSSxVQUFBLE9BQU8sSUFBSyxLQUFNLE1B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USxFQUFJLEVBQVEsRUFBSSxFQUFRLEdBR2pFLEVBQUEsV0FBZCxTQUEwQixHQUN0QixNQUFPLEdBQU8sT0FBTyxFQUFRLEVBQUksRUFBTyxjQUc5QixFQUFBLFFBQWQsU0FBdUIsRUFBZ0IsR0FDbkMsR0FBSSxHQUFJLEVBQUksRUFBTyxJQUFJLEVBQVEsRUFFL0IsT0FBTyxHQUFPLFVBQ1YsRUFDQSxFQUFPLE9BQU8sRUFBUSxLQUdsQyxJQXZFYSxTQUFBLE9BQU0iLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiaW1wb3J0IHsgVmVjdG9yIH0gZnJvbSBcIi4vVmVjdG9yXCI7XG5cbmV4cG9ydCBjbGFzcyBDYW1lcmEge1xuICAgIHByaXZhdGUgZGlyZWN0aW9uOiBWZWN0b3I7XG4gICAgcHJpdmF0ZSBwb3NpdGlvbjogVmVjdG9yO1xuICAgIHByaXZhdGUgZm9yd2FyZFZlY3RvcjogVmVjdG9yO1xuICAgIHByaXZhdGUgcmlnaHRWZWN0b3I6IFZlY3RvcjtcbiAgICBwcml2YXRlIHVwVmVjdG9yOiBWZWN0b3I7XG4gICAgcHJpdmF0ZSBzY3JlZW5XaWR0aDogbnVtYmVyO1xuICAgIHByaXZhdGUgc2NyZWVuSGVpZ2h0OiBudW1iZXI7XG5cbiAgICBjb25zdHJ1Y3RvciAocG9zaXRpb246IFZlY3RvciwgZGlyZWN0aW9uOiBWZWN0b3IsIHNjcmVlbldpZHRoOiBudW1iZXIsIHNjcmVlbkhlaWdodDogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMucG9zaXRpb24gPSBwb3NpdGlvbjtcbiAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSBWZWN0b3Iubm9ybWFsaXplZChkaXJlY3Rpb24pO1xuICAgICAgICB0aGlzLnNjcmVlbldpZHRoID0gc2NyZWVuV2lkdGg7XG4gICAgICAgIHRoaXMuc2NyZWVuSGVpZ2h0ID0gc2NyZWVuSGVpZ2h0O1xuXG4gICAgICAgIHRoaXMuZm9yd2FyZFZlY3RvciA9IFZlY3Rvci5ub3JtYWxpemVkKFZlY3Rvci5zdWJzdHJhY3QodGhpcy5kaXJlY3Rpb24sIHRoaXMucG9zaXRpb24pKTtcbiAgICAgICAgdGhpcy5yaWdodFZlY3RvciA9IFZlY3Rvci5zY2FsZWQoXG4gICAgICAgICAgICBWZWN0b3Iubm9ybWFsaXplZChcbiAgICAgICAgICAgICAgICBWZWN0b3IuY3Jvc3MoXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9yd2FyZFZlY3RvcixcbiAgICAgICAgICAgICAgICAgICAgbmV3IFZlY3RvcigwLCAtMSwgMClcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgM1xuICAgICAgICApO1xuICAgICAgICB0aGlzLnVwVmVjdG9yID0gVmVjdG9yLnNjYWxlZChcbiAgICAgICAgICAgIFZlY3Rvci5ub3JtYWxpemVkKFxuICAgICAgICAgICAgICAgIFZlY3Rvci5jcm9zcyhcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3J3YXJkVmVjdG9yLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJpZ2h0VmVjdG9yXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIDNcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0RGlyZWN0aW9uICgpOiBWZWN0b3Ige1xuICAgICAgICByZXR1cm4gdGhpcy5kaXJlY3Rpb247XG4gICAgfVxuXG4gICAgcHVibGljIGdldFBvc2l0aW9uICgpOiBWZWN0b3Ige1xuICAgICAgICByZXR1cm4gdGhpcy5wb3NpdGlvbjtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0Rm9yd2FyZFZlY3RvciAoKTogVmVjdG9yIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9yd2FyZFZlY3RvcjtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0UmlnaHRWZWN0b3IgKCk6IFZlY3RvciB7XG4gICAgICAgIHJldHVybiB0aGlzLnJpZ2h0VmVjdG9yO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRVcFZlY3RvciAoKTogVmVjdG9yIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudXBWZWN0b3I7XG4gICAgfVxuXG4gICAgcHVibGljIHJlY2VudGVyWCAoeDogbnVtYmVyKTogbnVtYmVyIHtcbiAgICAgICAgbGV0IGFzcGVjdENvZWZmID0gKHRoaXMuc2NyZWVuSGVpZ2h0IC8gdGhpcy5zY3JlZW5XaWR0aCkgKiAyO1xuXG4gICAgICAgIHJldHVybiAoeCAtICh0aGlzLnNjcmVlbldpZHRoIC8gMikpIC8gYXNwZWN0Q29lZmYgLyB0aGlzLnNjcmVlbldpZHRoO1xuICAgIH1cblxuICAgIHB1YmxpYyByZWNlbnRlclkgKHk6IG51bWJlcik6IG51bWJlciB7XG4gICAgICAgIHJldHVybiAtKHkgLSAodGhpcy5zY3JlZW5IZWlnaHQgLyAyKSkgLyAyIC8gdGhpcy5zY3JlZW5IZWlnaHQ7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgUkdCQ29sb3IgfSBmcm9tIFwiLi9SR0JDb2xvclwiO1xuaW1wb3J0IHsgRmxvYXRDb2xvciB9IGZyb20gXCIuL0Zsb2F0Q29sb3JcIjtcblxuZXhwb3J0IGNsYXNzIENvbG9yIHtcbiAgICByZWQ6IG51bWJlcjtcbiAgICBncmVlbjogbnVtYmVyO1xuICAgIGJsdWU6IG51bWJlcjtcblxuICAgIGNvbnN0cnVjdG9yIChjb2xvcjogUkdCQ29sb3J8RmxvYXRDb2xvcikge1xuICAgICAgICB0aGlzLnJlZCA9IGNvbG9yLnJlZDtcbiAgICAgICAgdGhpcy5ncmVlbiA9IGNvbG9yLmdyZWVuO1xuICAgICAgICB0aGlzLmJsdWUgPSBjb2xvci5ibHVlO1xuICAgIH1cblxuICAgIHB1YmxpYyBhZGQgKGNvbG9yOiBDb2xvcik6IENvbG9yIHtcbiAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihcbiAgICAgICAgICAgIG5ldyBGbG9hdENvbG9yKFxuICAgICAgICAgICAgICAgIHRoaXMucmVkICsgY29sb3IucmVkLFxuICAgICAgICAgICAgICAgIHRoaXMuZ3JlZW4gKyBjb2xvci5ncmVlbixcbiAgICAgICAgICAgICAgICB0aGlzLmJsdWUgKyBjb2xvci5ibHVlXG4gICAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcHVibGljIHN1YnN0cmFjdCAoY29sb3I6IENvbG9yKTogQ29sb3Ige1xuICAgICAgICByZXR1cm4gbmV3IENvbG9yKFxuICAgICAgICAgICAgbmV3IEZsb2F0Q29sb3IoXG4gICAgICAgICAgICAgICAgdGhpcy5yZWQgLSBjb2xvci5yZWQsXG4gICAgICAgICAgICAgICAgdGhpcy5ncmVlbiAtIGNvbG9yLmdyZWVuLFxuICAgICAgICAgICAgICAgIHRoaXMuYmx1ZSAtIGNvbG9yLmJsdWVcbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc2NhbGVkIChtdWx0aXBsaWVyOiBudW1iZXIpOiBDb2xvciB7XG4gICAgICAgIHJldHVybiBuZXcgQ29sb3IoXG4gICAgICAgICAgICBuZXcgRmxvYXRDb2xvcihcbiAgICAgICAgICAgICAgICB0aGlzLnJlZCAqIG11bHRpcGxpZXIsXG4gICAgICAgICAgICAgICAgdGhpcy5ncmVlbiAqIG11bHRpcGxpZXIsXG4gICAgICAgICAgICAgICAgdGhpcy5ibHVlICogbXVsdGlwbGllclxuICAgICAgICAgICAgKVxuICAgICAgICApO1xuICAgIH1cblxuICAgIHB1YmxpYyBtdWx0aXBsZSAoY29sb3I6IENvbG9yKTogQ29sb3Ige1xuICAgICAgICByZXR1cm4gbmV3IENvbG9yKFxuICAgICAgICAgICAgbmV3IEZsb2F0Q29sb3IoXG4gICAgICAgICAgICAgICAgdGhpcy5yZWQgKiBjb2xvci5yZWQsXG4gICAgICAgICAgICAgICAgdGhpcy5ncmVlbiAqIGNvbG9yLmdyZWVuLFxuICAgICAgICAgICAgICAgIHRoaXMuYmx1ZSAqIGNvbG9yLmJsdWVcbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZGl2aWRlICh2YWx1ZTogbnVtYmVyKTogQ29sb3Ige1xuICAgICAgICByZXR1cm4gbmV3IENvbG9yKFxuICAgICAgICAgICAgbmV3IEZsb2F0Q29sb3IoXG4gICAgICAgICAgICAgICAgdGhpcy5yZWQgLyB2YWx1ZSxcbiAgICAgICAgICAgICAgICB0aGlzLmdyZWVuIC8gdmFsdWUsXG4gICAgICAgICAgICAgICAgdGhpcy5ibHVlIC8gdmFsdWVcbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIHNSR0JFbmNvZGUgKGNvbG9yOiBudW1iZXIpIHtcbiAgICAgICAgaWYgKGNvbG9yIDw9IDAuMDAzMTMwOCkge1xuICAgICAgICAgICAgcmV0dXJuIDEyLjkyICogY29sb3I7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gMS4wNTUgKiAoY29sb3IgKiogMC40MTY2NjY3KSAtIDAuMDU1O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyB0b1JHQiAoY29sb3I6IENvbG9yKToge3JlZDogbnVtYmVyLCBncmVlbjogbnVtYmVyLCBibHVlOiBudW1iZXJ9IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlZDogTWF0aC5mbG9vcihDb2xvci5jbGFtcENvbG9yKGNvbG9yLnJlZCkgKiAyNTUpLFxuICAgICAgICAgICAgZ3JlZW46IE1hdGguZmxvb3IoQ29sb3IuY2xhbXBDb2xvcihjb2xvci5ncmVlbikgKiAyNTUpLFxuICAgICAgICAgICAgYmx1ZTogTWF0aC5mbG9vcihDb2xvci5jbGFtcENvbG9yKGNvbG9yLmJsdWUpICogMjU1KVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGF0aWMgY2xhbXBDb2xvciAoY29sb3I6IG51bWJlcik6IG51bWJlciB7XG4gICAgICAgIHJldHVybiBjb2xvciA+IDEgPyAxIDogY29sb3I7XG4gICAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIEZsb2F0Q29sb3Ige1xuICAgIHB1YmxpYyByZWQ6IG51bWJlcjtcbiAgICBwdWJsaWMgZ3JlZW46IG51bWJlcjtcbiAgICBwdWJsaWMgYmx1ZTogbnVtYmVyO1xuXG4gICAgY29uc3RydWN0b3IgKHJlZDogbnVtYmVyLCBncmVlbjogbnVtYmVyLCBibHVlOiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5yZWQgPSByZWQ7XG4gICAgICAgIHRoaXMuZ3JlZW4gPSBncmVlbjtcbiAgICAgICAgdGhpcy5ibHVlID0gYmx1ZTtcbiAgICB9XG59IiwiZXhwb3J0IGNsYXNzIFJHQkNvbG9yIHtcbiAgICBwdWJsaWMgcmVkOiBudW1iZXI7XG4gICAgcHVibGljIGdyZWVuOiBudW1iZXI7XG4gICAgcHVibGljIGJsdWU6IG51bWJlcjtcblxuICAgIGNvbnN0cnVjdG9yIChyZWQ6IG51bWJlciwgZ3JlZW46IG51bWJlciwgYmx1ZTogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMucmVkID0gUkdCQ29sb3IudG9GbG9hdChyZWQpO1xuICAgICAgICB0aGlzLmdyZWVuID0gUkdCQ29sb3IudG9GbG9hdChncmVlbik7XG4gICAgICAgIHRoaXMuYmx1ZSA9IFJHQkNvbG9yLnRvRmxvYXQoYmx1ZSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGF0aWMgdG9GbG9hdCAoY29sb3I6IG51bWJlcik6IG51bWJlciB7XG4gICAgICAgIHJldHVybiBjb2xvciA9PT0gMCA/IGNvbG9yIDogY29sb3IgLyAyNTU7XG4gICAgfVxufSIsImltcG9ydCB7IE1hdGVyaWFsIH0gZnJvbSBcIi4uL01hdGVyaWFsXCI7XG5pbXBvcnQgeyBSYXkgfSBmcm9tIFwiLi4vUmF5XCI7XG5pbXBvcnQgeyBWZWN0b3IgfSBmcm9tIFwiLi4vVmVjdG9yXCI7XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdExpZ2h0IHtcbiAgICBwdWJsaWMgYWJzdHJhY3QgZ2V0RmFkZVJhZGl1cyAoKTogbnVtYmVyO1xuICAgIHB1YmxpYyBhYnN0cmFjdCBnZXRQb3NpdGlvbiAoKTogVmVjdG9yO1xuICAgIHB1YmxpYyBhYnN0cmFjdCBnZXRQb3dlciAoKTogbnVtYmVyO1xuICAgIHB1YmxpYyBhYnN0cmFjdCBnZXRSYWRpdXMgKCk6IG51bWJlcjtcbiAgICBwdWJsaWMgYWJzdHJhY3QgZ2V0SW50ZXJzZWN0RGF0YSAocmF5OiBSYXkpOiBhbnk7XG4gICAgcHVibGljIGFic3RyYWN0IGdldE5vcm1hbCAocG9pbnQ6IFZlY3Rvcik6IFZlY3RvcjtcbiAgICBwdWJsaWMgYWJzdHJhY3QgZ2V0TWF0ZXJpYWwgKCk6IE1hdGVyaWFsO1xuICAgIHB1YmxpYyBhYnN0cmFjdCBnZXRSYW5kb21Qb2ludCAoKTogVmVjdG9yO1xuICAgIHB1YmxpYyBhYnN0cmFjdCBnZXRUeXBlICgpOiBzdHJpbmc7XG4gICAgcHVibGljIGFic3RyYWN0IHNldE1hdGVyaWFsIChtYXRlcmlhbDogTWF0ZXJpYWwpOiB0aGlzO1xufVxuIiwidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikge1xuICAgIGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdO1xuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbn07XG52YXIgQWJzdHJhY3RMaWdodF8xID0gcmVxdWlyZShcIi4vQWJzdHJhY3RMaWdodFwiKTtcbnZhciBDb2xvcl8xID0gcmVxdWlyZShcIi4vLi4vQ29sb3IvQ29sb3JcIik7XG52YXIgTWF0ZXJpYWxfMSA9IHJlcXVpcmUoXCIuLy4uL01hdGVyaWFsXCIpO1xudmFyIFJHQkNvbG9yXzEgPSByZXF1aXJlKFwiLi8uLi9Db2xvci9SR0JDb2xvclwiKTtcbnZhciBSVE1hdGhfMSA9IHJlcXVpcmUoXCIuLy4uL1JUTWF0aFwiKTtcbnZhciBWZWN0b3JfMSA9IHJlcXVpcmUoXCIuLy4uL1ZlY3RvclwiKTtcbnZhciBTcGhlcmljYWxMaWdodCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFNwaGVyaWNhbExpZ2h0LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNwaGVyaWNhbExpZ2h0KHBvc2l0aW9uLCBwb3dlciwgcmFkaXVzKSB7XG4gICAgICAgIF9zdXBlci5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLnJhZGl1cyA9IDUwO1xuICAgICAgICB0aGlzLmZhZGVSYWRpdXMgPSAyNTAwO1xuICAgICAgICB0aGlzLm1hdGVyaWFsID0gbmV3IE1hdGVyaWFsXzEuTWF0ZXJpYWwobmV3IENvbG9yXzEuQ29sb3IobmV3IFJHQkNvbG9yXzEuUkdCQ29sb3IoMjQ0LCAyNDQsIDI0NCkpLCAwKS5zZXRMYW1iZXJ0Q29lZmYoMSk7XG4gICAgICAgIHRoaXMudHlwZSA9ICdsaWdodCc7XG4gICAgICAgIHRoaXMucG9zaXRpb24gPSBwb3NpdGlvbjtcbiAgICAgICAgdGhpcy5wb3dlciA9IHBvd2VyO1xuICAgICAgICBpZiAocmFkaXVzKSB7XG4gICAgICAgICAgICB0aGlzLnJhZGl1cyA9IHJhZGl1cztcbiAgICAgICAgfVxuICAgIH1cbiAgICBTcGhlcmljYWxMaWdodC5wcm90b3R5cGUuZ2V0RmFkZVJhZGl1cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmFkaXVzICsgdGhpcy5mYWRlUmFkaXVzO1xuICAgIH07XG4gICAgU3BoZXJpY2FsTGlnaHQucHJvdG90eXBlLmdldFBvc2l0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wb3NpdGlvbjtcbiAgICB9O1xuICAgIFNwaGVyaWNhbExpZ2h0LnByb3RvdHlwZS5nZXRQb3dlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucG93ZXI7XG4gICAgfTtcbiAgICBTcGhlcmljYWxMaWdodC5wcm90b3R5cGUuZ2V0UmFkaXVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yYWRpdXM7XG4gICAgfTtcbiAgICBTcGhlcmljYWxMaWdodC5wcm90b3R5cGUuZ2V0UmFuZG9tUG9pbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB1ID0gTWF0aC5yYW5kb20oKSwgdiA9IE1hdGgucmFuZG9tKCksIHEgPSAyICogTWF0aC5QSSAqIHUsIGYgPSBNYXRoLnBvdyhNYXRoLmNvcygyICogdiAtIDEpLCAtMSk7XG4gICAgICAgIHJldHVybiBuZXcgVmVjdG9yXzEuVmVjdG9yKHRoaXMucmFkaXVzICogTWF0aC5jb3MocSkgKiBNYXRoLnNpbihmKSwgdGhpcy5yYWRpdXMgKiBNYXRoLnNpbihxKSAqIE1hdGguc2luKGYpLCB0aGlzLnJhZGl1cyAqIE1hdGguY29zKGYpKTtcbiAgICB9O1xuICAgIFNwaGVyaWNhbExpZ2h0LnByb3RvdHlwZS5nZXRJbnRlcnNlY3REYXRhID0gZnVuY3Rpb24gKHJheSkge1xuICAgICAgICB2YXIgayA9IFZlY3Rvcl8xLlZlY3Rvci5zdWJzdHJhY3QocmF5LmdldE9yaWdpbigpLCB0aGlzLnBvc2l0aW9uKSwgYiA9IFZlY3Rvcl8xLlZlY3Rvci5kb3QoaywgcmF5LmdldERpcmVjdGlvbigpKSwgYyA9IFZlY3Rvcl8xLlZlY3Rvci5kb3QoaywgaykgLSBNYXRoLnBvdyh0aGlzLnJhZGl1cywgMiksIGQgPSBNYXRoLnBvdyhiLCAyKSAtIGMsIHQxLCB0MiwgbWluVCwgbWF4VCwgaW50ZXJzZWN0aW9uUG9pbnQsIHBvaW50LCBkaXN0YW5jZTtcbiAgICAgICAgaWYgKGIgPiAwIHx8IGQgPCAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGQgPj0gMCkge1xuICAgICAgICAgICAgdDEgPSAtYiArIE1hdGguc3FydChkKTtcbiAgICAgICAgICAgIHQyID0gLWIgLSBNYXRoLnNxcnQoZCk7XG4gICAgICAgICAgICBtaW5UID0gTWF0aC5taW4odDEsIHQyKTtcbiAgICAgICAgICAgIG1heFQgPSBNYXRoLm1heCh0MSwgdDIpO1xuICAgICAgICAgICAgaWYgKG1pblQgPiBSVE1hdGhfMS5SVE1hdGguRVBTSUxPTikge1xuICAgICAgICAgICAgICAgIGludGVyc2VjdGlvblBvaW50ID0gbWluVDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGludGVyc2VjdGlvblBvaW50ID0gbWF4VDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpbnRlcnNlY3Rpb25Qb2ludCA8IFJUTWF0aF8xLlJUTWF0aC5FUFNJTE9OKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHBvaW50ID0gVmVjdG9yXzEuVmVjdG9yLmFkZChWZWN0b3JfMS5WZWN0b3Iuc2NhbGVkKHJheS5nZXREaXJlY3Rpb24oKSwgaW50ZXJzZWN0aW9uUG9pbnQpLCByYXkuZ2V0T3JpZ2luKCkpO1xuICAgICAgICBkaXN0YW5jZSA9IFZlY3Rvcl8xLlZlY3Rvci5zdWJzdHJhY3QocG9pbnQsIHJheS5nZXRPcmlnaW4oKSkuZ2V0TGVuZ3RoKCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBwb2ludDogcG9pbnQsXG4gICAgICAgICAgICBkaXN0YW5jZTogZGlzdGFuY2VcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFNwaGVyaWNhbExpZ2h0LnByb3RvdHlwZS5nZXROb3JtYWwgPSBmdW5jdGlvbiAocG9pbnQpIHtcbiAgICAgICAgcmV0dXJuIFZlY3Rvcl8xLlZlY3Rvci5ub3JtYWxpemVkKFZlY3Rvcl8xLlZlY3Rvci5zY2FsZWQoVmVjdG9yXzEuVmVjdG9yLnN1YnN0cmFjdChwb2ludCwgdGhpcy5wb3NpdGlvbiksIDEgLyB0aGlzLnJhZGl1cykpO1xuICAgIH07XG4gICAgU3BoZXJpY2FsTGlnaHQucHJvdG90eXBlLmdldE1hdGVyaWFsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tYXRlcmlhbDtcbiAgICB9O1xuICAgIFNwaGVyaWNhbExpZ2h0LnByb3RvdHlwZS5nZXRUeXBlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50eXBlO1xuICAgIH07XG4gICAgU3BoZXJpY2FsTGlnaHQucHJvdG90eXBlLnNldE1hdGVyaWFsID0gZnVuY3Rpb24gKG1hdGVyaWFsKSB7XG4gICAgICAgIHRoaXMubWF0ZXJpYWwgPSBtYXRlcmlhbDtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICByZXR1cm4gU3BoZXJpY2FsTGlnaHQ7XG59KShBYnN0cmFjdExpZ2h0XzEuQWJzdHJhY3RMaWdodCk7XG5leHBvcnRzLlNwaGVyaWNhbExpZ2h0ID0gU3BoZXJpY2FsTGlnaHQ7XG4iLCJpbXBvcnQgeyBBYnN0cmFjdExpZ2h0IH0gZnJvbSBcIi4vQWJzdHJhY3RMaWdodFwiO1xuaW1wb3J0IHsgQ29sb3IgfSBmcm9tIFwiLi8uLi9Db2xvci9Db2xvclwiO1xuaW1wb3J0IHsgTWF0ZXJpYWwgfSBmcm9tIFwiLi8uLi9NYXRlcmlhbFwiO1xuaW1wb3J0IHsgUmF5IH0gZnJvbSBcIi4vLi4vUmF5XCI7XG5pbXBvcnQgeyBSR0JDb2xvciB9IGZyb20gXCIuLy4uL0NvbG9yL1JHQkNvbG9yXCI7XG5pbXBvcnQgeyBSVE1hdGggfSBmcm9tIFwiLi8uLi9SVE1hdGhcIlxuaW1wb3J0IHsgVmVjdG9yIH0gZnJvbSBcIi4vLi4vVmVjdG9yXCI7XG5cbmV4cG9ydCBjbGFzcyBTcGhlcmljYWxMaWdodCBleHRlbmRzIEFic3RyYWN0TGlnaHQge1xuICAgIHByaXZhdGUgcG9zaXRpb246IFZlY3RvcjtcbiAgICBwcml2YXRlIHJhZGl1czogbnVtYmVyID0gNTA7XG4gICAgcHJpdmF0ZSBwb3dlcjogbnVtYmVyO1xuICAgIHByaXZhdGUgZmFkZVJhZGl1czogbnVtYmVyID0gMjUwMDtcbiAgICBwcml2YXRlIG1hdGVyaWFsOiBNYXRlcmlhbCA9IG5ldyBNYXRlcmlhbChuZXcgQ29sb3IobmV3IFJHQkNvbG9yKDI0NCwgMjQ0LCAyNDQpKSwgMCkuc2V0TGFtYmVydENvZWZmKDEpO1xuICAgIHByaXZhdGUgdHlwZTogc3RyaW5nID0gJ2xpZ2h0JztcblxuICAgIGNvbnN0cnVjdG9yIChwb3NpdGlvbjogVmVjdG9yLCBwb3dlcjogbnVtYmVyLCByYWRpdXM/OiBudW1iZXIpIHtcbiAgICAgICAgc3VwZXIoKTtcblxuICAgICAgICB0aGlzLnBvc2l0aW9uID0gcG9zaXRpb247XG4gICAgICAgIHRoaXMucG93ZXIgPSBwb3dlcjtcblxuICAgICAgICBpZiAocmFkaXVzKSB7XG4gICAgICAgICAgICB0aGlzLnJhZGl1cyA9IHJhZGl1cztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBnZXRGYWRlUmFkaXVzICgpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy5yYWRpdXMgKyB0aGlzLmZhZGVSYWRpdXM7XG4gICAgfVxuXG4gICAgcHVibGljIGdldFBvc2l0aW9uICgpOiBWZWN0b3Ige1xuICAgICAgICByZXR1cm4gdGhpcy5wb3NpdGlvbjtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0UG93ZXIgKCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLnBvd2VyO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRSYWRpdXMgKCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLnJhZGl1cztcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0UmFuZG9tUG9pbnQgKCk6IFZlY3RvciB7XG4gICAgICAgIGxldCB1ID0gTWF0aC5yYW5kb20oKSxcbiAgICAgICAgICAgIHYgPSBNYXRoLnJhbmRvbSgpLFxuICAgICAgICAgICAgcSA9IDIgKiBNYXRoLlBJICogdSxcbiAgICAgICAgICAgIGYgPSBNYXRoLnBvdyhNYXRoLmNvcygyICogdiAtIDEpLCAtMSk7XG5cbiAgICAgICAgcmV0dXJuIG5ldyBWZWN0b3IoXG4gICAgICAgICAgICB0aGlzLnJhZGl1cyAqIE1hdGguY29zKHEpICogTWF0aC5zaW4oZiksXG4gICAgICAgICAgICB0aGlzLnJhZGl1cyAqIE1hdGguc2luKHEpICogTWF0aC5zaW4oZiksXG4gICAgICAgICAgICB0aGlzLnJhZGl1cyAqIE1hdGguY29zKGYpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcHVibGljIGdldEludGVyc2VjdERhdGEgKHJheTogUmF5KTogYW55IHtcbiAgICAgICAgbGV0IGsgPSBWZWN0b3Iuc3Vic3RyYWN0KHJheS5nZXRPcmlnaW4oKSwgdGhpcy5wb3NpdGlvbiksXG4gICAgICAgICAgICBiOiBudW1iZXIgPSBWZWN0b3IuZG90KGssIHJheS5nZXREaXJlY3Rpb24oKSksXG4gICAgICAgICAgICBjOiBudW1iZXIgPSBWZWN0b3IuZG90KGssIGspIC0gdGhpcy5yYWRpdXMgKiogMixcbiAgICAgICAgICAgIGQ6IG51bWJlciA9IGIgKiogMiAtIGMsXG4gICAgICAgICAgICB0MTogbnVtYmVyLFxuICAgICAgICAgICAgdDI6IG51bWJlcixcbiAgICAgICAgICAgIG1pblQ6IG51bWJlcixcbiAgICAgICAgICAgIG1heFQ6IG51bWJlcixcbiAgICAgICAgICAgIGludGVyc2VjdGlvblBvaW50OiBudW1iZXIsXG4gICAgICAgICAgICBwb2ludDogVmVjdG9yLFxuICAgICAgICAgICAgZGlzdGFuY2U6IG51bWJlcjtcblxuICAgICAgICBpZiAoYiA+IDAgfHwgZCA8IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkID49IDApIHtcbiAgICAgICAgICAgIHQxID0gLWIgKyBNYXRoLnNxcnQoZCk7XG4gICAgICAgICAgICB0MiA9IC1iIC0gTWF0aC5zcXJ0KGQpO1xuICAgICAgICAgICAgbWluVCA9IE1hdGgubWluKHQxLCB0Mik7XG4gICAgICAgICAgICBtYXhUID0gTWF0aC5tYXgodDEsIHQyKTtcblxuICAgICAgICAgICAgaWYgKG1pblQgPiBSVE1hdGguRVBTSUxPTikge1xuICAgICAgICAgICAgICAgIGludGVyc2VjdGlvblBvaW50ID0gbWluVDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaW50ZXJzZWN0aW9uUG9pbnQgPSBtYXhUO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoaW50ZXJzZWN0aW9uUG9pbnQgPCBSVE1hdGguRVBTSUxPTikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHBvaW50ID0gVmVjdG9yLmFkZChcbiAgICAgICAgICAgIFZlY3Rvci5zY2FsZWQocmF5LmdldERpcmVjdGlvbigpLCBpbnRlcnNlY3Rpb25Qb2ludCksXG4gICAgICAgICAgICByYXkuZ2V0T3JpZ2luKClcbiAgICAgICAgKTtcbiAgICAgICAgZGlzdGFuY2UgPSBWZWN0b3Iuc3Vic3RyYWN0KFxuICAgICAgICAgICAgcG9pbnQsXG4gICAgICAgICAgICByYXkuZ2V0T3JpZ2luKClcbiAgICAgICAgKS5nZXRMZW5ndGgoKTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcG9pbnQsXG4gICAgICAgICAgICBkaXN0YW5jZVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXROb3JtYWwgKHBvaW50OiBWZWN0b3IpOiBWZWN0b3Ige1xuICAgICAgICByZXR1cm4gVmVjdG9yLm5vcm1hbGl6ZWQoXG4gICAgICAgICAgICBWZWN0b3Iuc2NhbGVkKFxuICAgICAgICAgICAgICAgIFZlY3Rvci5zdWJzdHJhY3QocG9pbnQsIHRoaXMucG9zaXRpb24pLFxuICAgICAgICAgICAgICAgIDEgLyB0aGlzLnJhZGl1c1xuICAgICAgICAgICAgKVxuICAgICAgICApO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRNYXRlcmlhbCAoKTogTWF0ZXJpYWwge1xuICAgICAgICByZXR1cm4gdGhpcy5tYXRlcmlhbDtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0VHlwZSAoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudHlwZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc2V0TWF0ZXJpYWwgKG1hdGVyaWFsOiBNYXRlcmlhbCk6IHRoaXMge1xuICAgICAgICB0aGlzLm1hdGVyaWFsID0gbWF0ZXJpYWw7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ29sb3IgfSBmcm9tIFwiLi9Db2xvci9Db2xvclwiO1xuaW1wb3J0IHsgUkdCQ29sb3IgfSBmcm9tIFwiLi9Db2xvci9SR0JDb2xvclwiO1xuXG5leHBvcnQgY2xhc3MgTWF0ZXJpYWwge1xuICAgIHByaXZhdGUgY29sb3I6IENvbG9yO1xuICAgIHByaXZhdGUgbGFtYmVydENvZWZmOiBudW1iZXIgPSAwLjU7XG4gICAgcHJpdmF0ZSBwaG9uZ0NvZWZmOiBudW1iZXIgPSAwLjU7XG4gICAgcHJpdmF0ZSByZWZsZWN0aW9uQ29lZmY6IG51bWJlciA9IDA7XG5cbiAgICBjb25zdHJ1Y3RvciAoXG4gICAgICAgIGNvbG9yOiBDb2xvciA9IG5ldyBDb2xvcihuZXcgUkdCQ29sb3IoMjU1LCAwLCAwKSksXG4gICAgICAgIHJlZmxlY3Rpb25Db2VmZjogbnVtYmVyID0gMFxuICAgICkge1xuICAgICAgICB0aGlzLmNvbG9yID0gY29sb3I7XG4gICAgICAgIHRoaXMucmVmbGVjdGlvbkNvZWZmID0gcmVmbGVjdGlvbkNvZWZmO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRDb2xvciAoKTogQ29sb3Ige1xuICAgICAgICByZXR1cm4gdGhpcy5jb2xvcjtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0TGFtYmVydENvZWZmKCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLmxhbWJlcnRDb2VmZjtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0UGhvbmdDb2VmZigpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy5waG9uZ0NvZWZmO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRSZWZsZWN0aW9uVmFsdWUgKCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlZmxlY3Rpb25Db2VmZjtcbiAgICB9XG5cbiAgICBwdWJsaWMgc2V0TGFtYmVydENvZWZmKGxhbWJlcnRDb2VmZjogbnVtYmVyKTogdGhpcyB7XG4gICAgICAgIHRoaXMubGFtYmVydENvZWZmID0gbGFtYmVydENvZWZmO1xuICAgICAgICB0aGlzLnBob25nQ29lZmYgPSAxIC0gbGFtYmVydENvZWZmO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIHB1YmxpYyBzZXRQaG9uZ0NvZWZmKHBob25nQ29lZmY6IG51bWJlcik6IHRoaXMge1xuICAgICAgICB0aGlzLnBob25nQ29lZmYgPSBwaG9uZ0NvZWZmO1xuICAgICAgICB0aGlzLmxhbWJlcnRDb2VmZiA9IDEgLSBwaG9uZ0NvZWZmO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbn0iLCJpbXBvcnQgeyBNYXRlcmlhbCB9IGZyb20gXCIuLi9NYXRlcmlhbFwiO1xuaW1wb3J0IHsgUmF5IH0gZnJvbSBcIi4uL1JheVwiO1xuaW1wb3J0IHsgVmVjdG9yIH0gZnJvbSBcIi4uL1ZlY3RvclwiO1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQWJzdHJhY3RPYmplY3Qge1xuICAgIGFic3RyYWN0IGdldE1hdGVyaWFsICgpOiBNYXRlcmlhbDtcbiAgICBhYnN0cmFjdCBzZXRNYXRlcmlhbCAobWF0ZXJpYWw6IE1hdGVyaWFsKTogdGhpcztcbiAgICBhYnN0cmFjdCBnZXRJbnRlcnNlY3REYXRhIChyYXk6IFJheSk6IGFueTtcbn1cbiIsInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgZnVuY3Rpb24gKGQsIGIpIHtcbiAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTtcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG59O1xudmFyIFJUTWF0aF8xID0gcmVxdWlyZShcIi4uL1JUTWF0aFwiKTtcbnZhciBBYnN0cmFjdE9iamVjdF8xID0gcmVxdWlyZShcIi4vQWJzdHJhY3RPYmplY3RcIik7XG52YXIgQ29sb3JfMSA9IHJlcXVpcmUoXCIuLi9Db2xvci9Db2xvclwiKTtcbnZhciBNYXRlcmlhbF8xID0gcmVxdWlyZShcIi4uL01hdGVyaWFsXCIpO1xudmFyIFJHQkNvbG9yXzEgPSByZXF1aXJlKFwiLi4vQ29sb3IvUkdCQ29sb3JcIik7XG52YXIgVmVjdG9yXzEgPSByZXF1aXJlKFwiLi4vVmVjdG9yXCIpO1xudmFyIFBvbHlnb24gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhQb2x5Z29uLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFBvbHlnb24oKSB7XG4gICAgICAgIHZhciB2ZXJ0aWNlcyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmVydGljZXNbX2kgLSAwXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgX3N1cGVyLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMubWF0ZXJpYWwgPSBuZXcgTWF0ZXJpYWxfMS5NYXRlcmlhbChuZXcgQ29sb3JfMS5Db2xvcihuZXcgUkdCQ29sb3JfMS5SR0JDb2xvcigxMTUsIDExNSwgMTE1KSksIDApO1xuICAgICAgICB0aGlzLnR5cGUgPSAnc3VyZmFjZSc7XG4gICAgICAgIHRoaXMudmVydGljZXMgPSB2ZXJ0aWNlcztcbiAgICB9XG4gICAgUG9seWdvbi5wcm90b3R5cGUuZ2V0SW50ZXJzZWN0RGF0YSA9IGZ1bmN0aW9uIChyYXkpIHtcbiAgICAgICAgdmFyIGRpc3RhbmNlLCBkaXN0YW5jZUZyb21BeGlzQ2VudGVyLCBoaXRQb2ludCwgbm9ybWFsID0gdGhpcy5nZXROb3JtYWwoKSwgbnVtZXJhdG9yLCBkZW5vbWluYXRvcjtcbiAgICAgICAgZGlzdGFuY2VGcm9tQXhpc0NlbnRlciA9IFZlY3Rvcl8xLlZlY3Rvci5kb3QodGhpcy52ZXJ0aWNlc1swXSwgbm9ybWFsKTtcbiAgICAgICAgZGVub21pbmF0b3IgPSBWZWN0b3JfMS5WZWN0b3IuZG90KG5vcm1hbCwgcmF5LmdldERpcmVjdGlvbigpKTtcbiAgICAgICAgbnVtZXJhdG9yID0gLVZlY3Rvcl8xLlZlY3Rvci5kb3Qobm9ybWFsLCByYXkuZ2V0T3JpZ2luKCkpICsgZGlzdGFuY2VGcm9tQXhpc0NlbnRlcjtcbiAgICAgICAgZGlzdGFuY2UgPSBudW1lcmF0b3IgLyBkZW5vbWluYXRvcjtcbiAgICAgICAgaWYgKGRpc3RhbmNlIDwgUlRNYXRoXzEuUlRNYXRoLkVQU0lMT04pIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICByYXkuc2V0RGlzdGFuY2UoZGlzdGFuY2UpO1xuICAgICAgICBoaXRQb2ludCA9IHJheS5nZXRIaXRQb2ludCgpO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgdmVydGljZXNMZW5ndGggPSB0aGlzLnZlcnRpY2VzLmxlbmd0aDsgaSA8IHZlcnRpY2VzTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciB2ZXJ0ZXgxID0gdGhpcy52ZXJ0aWNlc1tpXSwgdmVydGV4MiA9IHZvaWQgMDtcbiAgICAgICAgICAgIGlmIChpID09PSB2ZXJ0aWNlc0xlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICB2ZXJ0ZXgyID0gdGhpcy52ZXJ0aWNlc1swXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZlcnRleDIgPSB0aGlzLnZlcnRpY2VzW2kgKyAxXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghUG9seWdvbi5jaGVja1NhbWVDbG9ja0RpcihWZWN0b3JfMS5WZWN0b3Iuc3Vic3RyYWN0KHZlcnRleDIsIHZlcnRleDEpLCBWZWN0b3JfMS5WZWN0b3Iuc3Vic3RyYWN0KGhpdFBvaW50LCB2ZXJ0ZXgxKSwgdGhpcy5nZXROb3JtYWwoKSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZGlzdGFuY2UgPSBWZWN0b3JfMS5WZWN0b3Iuc3Vic3RyYWN0KGhpdFBvaW50LCByYXkuZ2V0T3JpZ2luKCkpLmdldExlbmd0aCgpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcG9pbnQ6IGhpdFBvaW50LFxuICAgICAgICAgICAgZGlzdGFuY2U6IGRpc3RhbmNlXG4gICAgICAgIH07XG4gICAgfTtcbiAgICBQb2x5Z29uLnByb3RvdHlwZS5nZXRNYXRlcmlhbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubWF0ZXJpYWw7XG4gICAgfTtcbiAgICBQb2x5Z29uLnByb3RvdHlwZS5nZXROb3JtYWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBlZGdlMSA9IFZlY3Rvcl8xLlZlY3Rvci5zdWJzdHJhY3QodGhpcy52ZXJ0aWNlc1syXSwgdGhpcy52ZXJ0aWNlc1swXSksIGVkZ2UyID0gVmVjdG9yXzEuVmVjdG9yLnN1YnN0cmFjdCh0aGlzLnZlcnRpY2VzWzFdLCB0aGlzLnZlcnRpY2VzWzBdKTtcbiAgICAgICAgcmV0dXJuIFZlY3Rvcl8xLlZlY3Rvci5ub3JtYWxpemVkKFZlY3Rvcl8xLlZlY3Rvci5jcm9zcyhlZGdlMSwgZWRnZTIpKTtcbiAgICB9O1xuICAgIFBvbHlnb24ucHJvdG90eXBlLmdldFR5cGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnR5cGU7XG4gICAgfTtcbiAgICBQb2x5Z29uLnByb3RvdHlwZS5zZXRNYXRlcmlhbCA9IGZ1bmN0aW9uIChtYXRlcmlhbCkge1xuICAgICAgICB0aGlzLm1hdGVyaWFsID0gbWF0ZXJpYWw7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgUG9seWdvbi5jaGVja1NhbWVDbG9ja0RpciA9IGZ1bmN0aW9uICh2ZWN0b3IxLCB2ZWN0b3IyLCBub3JtYWwpIHtcbiAgICAgICAgdmFyIG5vcm1hbFYxVjIgPSBWZWN0b3JfMS5WZWN0b3IuY3Jvc3ModmVjdG9yMiwgdmVjdG9yMSk7XG4gICAgICAgIHJldHVybiBWZWN0b3JfMS5WZWN0b3IuZG90KG5vcm1hbFYxVjIsIG5vcm1hbCkgPj0gMDtcbiAgICB9O1xuICAgIHJldHVybiBQb2x5Z29uO1xufSkoQWJzdHJhY3RPYmplY3RfMS5BYnN0cmFjdE9iamVjdCk7XG5leHBvcnRzLlBvbHlnb24gPSBQb2x5Z29uO1xuIiwiaW1wb3J0IHsgUlRNYXRoIH0gZnJvbSBcIi4uL1JUTWF0aFwiO1xuaW1wb3J0IHsgQWJzdHJhY3RPYmplY3QgfSBmcm9tIFwiLi9BYnN0cmFjdE9iamVjdFwiO1xuaW1wb3J0IHsgQ29sb3IgfSBmcm9tIFwiLi4vQ29sb3IvQ29sb3JcIjtcbmltcG9ydCB7IE1hdGVyaWFsIH0gZnJvbSBcIi4uL01hdGVyaWFsXCI7XG5pbXBvcnQgeyBSYXkgfSBmcm9tIFwiLi4vUmF5XCI7XG5pbXBvcnQgeyBSR0JDb2xvciB9IGZyb20gXCIuLi9Db2xvci9SR0JDb2xvclwiO1xuaW1wb3J0IHsgVmVjdG9yIH0gZnJvbSBcIi4uL1ZlY3RvclwiO1xuXG5leHBvcnQgY2xhc3MgUG9seWdvbiBleHRlbmRzIEFic3RyYWN0T2JqZWN0IHtcbiAgICBwcml2YXRlIHZlcnRpY2VzOiBWZWN0b3JbXTtcbiAgICBwcml2YXRlIG1hdGVyaWFsOiBNYXRlcmlhbCA9IG5ldyBNYXRlcmlhbChuZXcgQ29sb3IobmV3IFJHQkNvbG9yKDExNSwgMTE1LCAxMTUpKSwgMCk7XG4gICAgcHJpdmF0ZSB0eXBlOiBzdHJpbmcgPSAnc3VyZmFjZSc7XG5cbiAgICBjb25zdHJ1Y3RvciAoLi4udmVydGljZXM6IFZlY3RvcltdKSB7XG4gICAgICAgIHN1cGVyICgpO1xuXG4gICAgICAgIHRoaXMudmVydGljZXMgPSB2ZXJ0aWNlcztcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0SW50ZXJzZWN0RGF0YSAocmF5OiBSYXkpOiBhbnkge1xuICAgICAgICBsZXQgZGlzdGFuY2U6IG51bWJlcixcbiAgICAgICAgICAgIGRpc3RhbmNlRnJvbUF4aXNDZW50ZXI6IG51bWJlcixcbiAgICAgICAgICAgIGhpdFBvaW50OiBWZWN0b3IsXG4gICAgICAgICAgICBub3JtYWw6IFZlY3RvciA9IHRoaXMuZ2V0Tm9ybWFsKCksXG4gICAgICAgICAgICBudW1lcmF0b3I6IG51bWJlcixcbiAgICAgICAgICAgIGRlbm9taW5hdG9yOiBudW1iZXI7XG5cbiAgICAgICAgZGlzdGFuY2VGcm9tQXhpc0NlbnRlciA9IFZlY3Rvci5kb3QodGhpcy52ZXJ0aWNlc1swXSwgbm9ybWFsKTtcblxuICAgICAgICBkZW5vbWluYXRvciA9IFZlY3Rvci5kb3Qobm9ybWFsLCByYXkuZ2V0RGlyZWN0aW9uKCkpO1xuICAgICAgICBudW1lcmF0b3IgPSAtVmVjdG9yLmRvdChub3JtYWwsIHJheS5nZXRPcmlnaW4oKSkgKyBkaXN0YW5jZUZyb21BeGlzQ2VudGVyO1xuXG4gICAgICAgIGRpc3RhbmNlID0gbnVtZXJhdG9yIC8gZGVub21pbmF0b3I7XG5cbiAgICAgICAgaWYgKGRpc3RhbmNlIDwgUlRNYXRoLkVQU0lMT04pIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJheS5zZXREaXN0YW5jZShkaXN0YW5jZSk7XG5cbiAgICAgICAgaGl0UG9pbnQgPSByYXkuZ2V0SGl0UG9pbnQoKTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMCwgdmVydGljZXNMZW5ndGggPSB0aGlzLnZlcnRpY2VzLmxlbmd0aDsgaSA8IHZlcnRpY2VzTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGxldCB2ZXJ0ZXgxOiBWZWN0b3IgPSB0aGlzLnZlcnRpY2VzW2ldLFxuICAgICAgICAgICAgICAgIHZlcnRleDI6IFZlY3RvcjtcblxuICAgICAgICAgICAgaWYgKGkgPT09IHZlcnRpY2VzTGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgIHZlcnRleDIgPSB0aGlzLnZlcnRpY2VzWzBdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2ZXJ0ZXgyID0gdGhpcy52ZXJ0aWNlc1tpICsgMV07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAhUG9seWdvbi5jaGVja1NhbWVDbG9ja0RpcihcbiAgICAgICAgICAgICAgICAgICAgVmVjdG9yLnN1YnN0cmFjdCh2ZXJ0ZXgyLCB2ZXJ0ZXgxKSxcbiAgICAgICAgICAgICAgICAgICAgVmVjdG9yLnN1YnN0cmFjdChoaXRQb2ludCwgdmVydGV4MSksXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0Tm9ybWFsKClcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBkaXN0YW5jZSA9IFZlY3Rvci5zdWJzdHJhY3QoXG4gICAgICAgICAgICBoaXRQb2ludCxcbiAgICAgICAgICAgIHJheS5nZXRPcmlnaW4oKVxuICAgICAgICApLmdldExlbmd0aCgpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBwb2ludDogaGl0UG9pbnQsXG4gICAgICAgICAgICBkaXN0YW5jZVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRNYXRlcmlhbCAoKTogTWF0ZXJpYWwge1xuICAgICAgICByZXR1cm4gdGhpcy5tYXRlcmlhbDtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0Tm9ybWFsICgpOiBWZWN0b3Ige1xuICAgICAgICBsZXQgZWRnZTE6IFZlY3RvciA9IFZlY3Rvci5zdWJzdHJhY3QodGhpcy52ZXJ0aWNlc1syXSwgdGhpcy52ZXJ0aWNlc1swXSksXG4gICAgICAgICAgICBlZGdlMjogVmVjdG9yID0gVmVjdG9yLnN1YnN0cmFjdCh0aGlzLnZlcnRpY2VzWzFdLCB0aGlzLnZlcnRpY2VzWzBdKTtcblxuICAgICAgICByZXR1cm4gVmVjdG9yLm5vcm1hbGl6ZWQoVmVjdG9yLmNyb3NzKGVkZ2UxLCBlZGdlMikpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRUeXBlICgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy50eXBlO1xuICAgIH1cblxuICAgIHB1YmxpYyBzZXRNYXRlcmlhbCAobWF0ZXJpYWw6IE1hdGVyaWFsKTogdGhpcyB7XG4gICAgICAgIHRoaXMubWF0ZXJpYWwgPSBtYXRlcmlhbDtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBwcml2YXRlIHN0YXRpYyBjaGVja1NhbWVDbG9ja0RpciAodmVjdG9yMTogVmVjdG9yLCB2ZWN0b3IyOiBWZWN0b3IsIG5vcm1hbDogVmVjdG9yKTogYm9vbGVhbiB7XG4gICAgICAgIGxldCBub3JtYWxWMVYyOiBWZWN0b3IgPSBWZWN0b3IuY3Jvc3ModmVjdG9yMiwgdmVjdG9yMSk7XG5cbiAgICAgICAgcmV0dXJuIFZlY3Rvci5kb3Qobm9ybWFsVjFWMiwgbm9ybWFsKSA+PSAwO1xuICAgIH1cbn1cbiIsInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgZnVuY3Rpb24gKGQsIGIpIHtcbiAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTtcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG59O1xudmFyIFJUTWF0aF8xID0gcmVxdWlyZShcIi4uL1JUTWF0aFwiKTtcbnZhciBBYnN0cmFjdE9iamVjdF8xID0gcmVxdWlyZShcIi4vQWJzdHJhY3RPYmplY3RcIik7XG52YXIgQ29sb3JfMSA9IHJlcXVpcmUoXCIuLi9Db2xvci9Db2xvclwiKTtcbnZhciBNYXRlcmlhbF8xID0gcmVxdWlyZShcIi4uL01hdGVyaWFsXCIpO1xudmFyIFJHQkNvbG9yXzEgPSByZXF1aXJlKFwiLi4vQ29sb3IvUkdCQ29sb3JcIik7XG52YXIgVmVjdG9yXzEgPSByZXF1aXJlKFwiLi4vVmVjdG9yXCIpO1xudmFyIFNwaGVyZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFNwaGVyZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTcGhlcmUoY2VudGVyLCByYWRpdXMpIHtcbiAgICAgICAgX3N1cGVyLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMubWF0ZXJpYWwgPSBuZXcgTWF0ZXJpYWxfMS5NYXRlcmlhbChuZXcgQ29sb3JfMS5Db2xvcihuZXcgUkdCQ29sb3JfMS5SR0JDb2xvcigyNTUsIDAsIDApKSwgMCk7XG4gICAgICAgIHRoaXMudHlwZSA9ICdzdXJmYWNlJztcbiAgICAgICAgdGhpcy5jZW50ZXIgPSBjZW50ZXI7XG4gICAgICAgIHRoaXMucmFkaXVzID0gcmFkaXVzO1xuICAgIH1cbiAgICBTcGhlcmUucHJvdG90eXBlLmdldEludGVyc2VjdERhdGEgPSBmdW5jdGlvbiAocmF5KSB7XG4gICAgICAgIHZhciBrID0gVmVjdG9yXzEuVmVjdG9yLnN1YnN0cmFjdChyYXkuZ2V0T3JpZ2luKCksIHRoaXMuY2VudGVyKSwgYiA9IFZlY3Rvcl8xLlZlY3Rvci5kb3QoaywgcmF5LmdldERpcmVjdGlvbigpKSwgYyA9IFZlY3Rvcl8xLlZlY3Rvci5kb3QoaywgaykgLSBNYXRoLnBvdyh0aGlzLnJhZGl1cywgMiksIGQgPSBNYXRoLnBvdyhiLCAyKSAtIGMsIHQxLCB0MiwgbWluVCwgbWF4VCwgaW50ZXJzZWN0aW9uUG9pbnQsIHBvaW50LCBkaXN0YW5jZTtcbiAgICAgICAgaWYgKGIgPiAwIHx8IGQgPCAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGQgPj0gMCkge1xuICAgICAgICAgICAgdDEgPSAtYiArIE1hdGguc3FydChkKTtcbiAgICAgICAgICAgIHQyID0gLWIgLSBNYXRoLnNxcnQoZCk7XG4gICAgICAgICAgICBtaW5UID0gTWF0aC5taW4odDEsIHQyKTtcbiAgICAgICAgICAgIG1heFQgPSBNYXRoLm1heCh0MSwgdDIpO1xuICAgICAgICAgICAgaWYgKG1pblQgPiBSVE1hdGhfMS5SVE1hdGguRVBTSUxPTikge1xuICAgICAgICAgICAgICAgIGludGVyc2VjdGlvblBvaW50ID0gbWluVDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGludGVyc2VjdGlvblBvaW50ID0gbWF4VDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpbnRlcnNlY3Rpb25Qb2ludCA8IFJUTWF0aF8xLlJUTWF0aC5FUFNJTE9OKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHBvaW50ID0gVmVjdG9yXzEuVmVjdG9yLmFkZChWZWN0b3JfMS5WZWN0b3Iuc2NhbGVkKHJheS5nZXREaXJlY3Rpb24oKSwgaW50ZXJzZWN0aW9uUG9pbnQpLCByYXkuZ2V0T3JpZ2luKCkpO1xuICAgICAgICBkaXN0YW5jZSA9IFZlY3Rvcl8xLlZlY3Rvci5zdWJzdHJhY3QocG9pbnQsIHJheS5nZXRPcmlnaW4oKSkuZ2V0TGVuZ3RoKCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBwb2ludDogcG9pbnQsXG4gICAgICAgICAgICBkaXN0YW5jZTogZGlzdGFuY2VcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFNwaGVyZS5wcm90b3R5cGUuZ2V0TWF0ZXJpYWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1hdGVyaWFsO1xuICAgIH07XG4gICAgU3BoZXJlLnByb3RvdHlwZS5nZXROb3JtYWwgPSBmdW5jdGlvbiAocG9pbnQpIHtcbiAgICAgICAgcmV0dXJuIFZlY3Rvcl8xLlZlY3Rvci5ub3JtYWxpemVkKFZlY3Rvcl8xLlZlY3Rvci5zY2FsZWQoVmVjdG9yXzEuVmVjdG9yLnN1YnN0cmFjdChwb2ludCwgdGhpcy5jZW50ZXIpLCAxIC8gdGhpcy5yYWRpdXMpKTtcbiAgICB9O1xuICAgIFNwaGVyZS5wcm90b3R5cGUuZ2V0VHlwZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudHlwZTtcbiAgICB9O1xuICAgIFNwaGVyZS5wcm90b3R5cGUuc2V0TWF0ZXJpYWwgPSBmdW5jdGlvbiAobWF0ZXJpYWwpIHtcbiAgICAgICAgdGhpcy5tYXRlcmlhbCA9IG1hdGVyaWFsO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIHJldHVybiBTcGhlcmU7XG59KShBYnN0cmFjdE9iamVjdF8xLkFic3RyYWN0T2JqZWN0KTtcbmV4cG9ydHMuU3BoZXJlID0gU3BoZXJlO1xuIiwiaW1wb3J0IHsgUlRNYXRoIH0gZnJvbSBcIi4uL1JUTWF0aFwiO1xuaW1wb3J0IHsgQWJzdHJhY3RPYmplY3QgfSBmcm9tIFwiLi9BYnN0cmFjdE9iamVjdFwiO1xuaW1wb3J0IHsgQ29sb3IgfSBmcm9tIFwiLi4vQ29sb3IvQ29sb3JcIjtcbmltcG9ydCB7IE1hdGVyaWFsIH0gZnJvbSBcIi4uL01hdGVyaWFsXCI7XG5pbXBvcnQgeyBSYXkgfSBmcm9tIFwiLi4vUmF5XCI7XG5pbXBvcnQgeyBSR0JDb2xvciB9IGZyb20gXCIuLi9Db2xvci9SR0JDb2xvclwiO1xuaW1wb3J0IHsgVmVjdG9yIH0gZnJvbSBcIi4uL1ZlY3RvclwiO1xuXG5leHBvcnQgY2xhc3MgU3BoZXJlIGV4dGVuZHMgQWJzdHJhY3RPYmplY3Qge1xuICAgIHByaXZhdGUgY2VudGVyOiBWZWN0b3I7XG4gICAgcHJpdmF0ZSByYWRpdXM6IG51bWJlcjtcbiAgICBwcml2YXRlIG1hdGVyaWFsOiBNYXRlcmlhbCA9IG5ldyBNYXRlcmlhbChuZXcgQ29sb3IobmV3IFJHQkNvbG9yKDI1NSwgMCwgMCkpLCAwKTtcbiAgICBwcml2YXRlIHR5cGU6IHN0cmluZyA9ICdzdXJmYWNlJztcblxuICAgIGNvbnN0cnVjdG9yIChjZW50ZXI6IFZlY3RvciwgcmFkaXVzOiBudW1iZXIpIHtcbiAgICAgICAgc3VwZXIgKCk7XG5cbiAgICAgICAgdGhpcy5jZW50ZXIgPSBjZW50ZXI7XG4gICAgICAgIHRoaXMucmFkaXVzID0gcmFkaXVzO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRJbnRlcnNlY3REYXRhIChyYXk6IFJheSk6IGFueSB7XG4gICAgICAgIGxldCBrID0gVmVjdG9yLnN1YnN0cmFjdChyYXkuZ2V0T3JpZ2luKCksIHRoaXMuY2VudGVyKSxcbiAgICAgICAgICAgIGI6IG51bWJlciA9IFZlY3Rvci5kb3QoaywgcmF5LmdldERpcmVjdGlvbigpKSxcbiAgICAgICAgICAgIGM6IG51bWJlciA9IFZlY3Rvci5kb3QoaywgaykgLSB0aGlzLnJhZGl1cyAqKiAyLFxuICAgICAgICAgICAgZDogbnVtYmVyID0gYiAqKiAyIC0gYyxcbiAgICAgICAgICAgIHQxOiBudW1iZXIsXG4gICAgICAgICAgICB0MjogbnVtYmVyLFxuICAgICAgICAgICAgbWluVDogbnVtYmVyLFxuICAgICAgICAgICAgbWF4VDogbnVtYmVyLFxuICAgICAgICAgICAgaW50ZXJzZWN0aW9uUG9pbnQ6IG51bWJlcixcbiAgICAgICAgICAgIHBvaW50OiBWZWN0b3IsXG4gICAgICAgICAgICBkaXN0YW5jZTogbnVtYmVyO1xuXG4gICAgICAgIGlmIChiID4gMCB8fCBkIDwgMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGQgPj0gMCkge1xuICAgICAgICAgICAgdDEgPSAtYiArIE1hdGguc3FydChkKTtcbiAgICAgICAgICAgIHQyID0gLWIgLSBNYXRoLnNxcnQoZCk7XG4gICAgICAgICAgICBtaW5UID0gTWF0aC5taW4odDEsIHQyKTtcbiAgICAgICAgICAgIG1heFQgPSBNYXRoLm1heCh0MSwgdDIpO1xuXG4gICAgICAgICAgICBpZiAobWluVCA+IFJUTWF0aC5FUFNJTE9OKSB7XG4gICAgICAgICAgICAgICAgaW50ZXJzZWN0aW9uUG9pbnQgPSBtaW5UO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpbnRlcnNlY3Rpb25Qb2ludCA9IG1heFQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChpbnRlcnNlY3Rpb25Qb2ludCA8IFJUTWF0aC5FUFNJTE9OKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcG9pbnQgPSBWZWN0b3IuYWRkKFxuICAgICAgICAgICAgVmVjdG9yLnNjYWxlZChyYXkuZ2V0RGlyZWN0aW9uKCksIGludGVyc2VjdGlvblBvaW50KSxcbiAgICAgICAgICAgIHJheS5nZXRPcmlnaW4oKVxuICAgICAgICApO1xuICAgICAgICBkaXN0YW5jZSA9IFZlY3Rvci5zdWJzdHJhY3QoXG4gICAgICAgICAgICBwb2ludCxcbiAgICAgICAgICAgIHJheS5nZXRPcmlnaW4oKVxuICAgICAgICApLmdldExlbmd0aCgpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBwb2ludCxcbiAgICAgICAgICAgIGRpc3RhbmNlXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcHVibGljIGdldE1hdGVyaWFsICgpOiBNYXRlcmlhbCB7XG4gICAgICAgIHJldHVybiB0aGlzLm1hdGVyaWFsO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXROb3JtYWwgKHBvaW50OiBWZWN0b3IpOiBWZWN0b3Ige1xuICAgICAgICByZXR1cm4gVmVjdG9yLm5vcm1hbGl6ZWQoXG4gICAgICAgICAgICBWZWN0b3Iuc2NhbGVkKFxuICAgICAgICAgICAgICAgIFZlY3Rvci5zdWJzdHJhY3QocG9pbnQsIHRoaXMuY2VudGVyKSxcbiAgICAgICAgICAgICAgICAxIC8gdGhpcy5yYWRpdXNcbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0VHlwZSAoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudHlwZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc2V0TWF0ZXJpYWwgKG1hdGVyaWFsOiBNYXRlcmlhbCk6IHRoaXMge1xuICAgICAgICB0aGlzLm1hdGVyaWFsID0gbWF0ZXJpYWw7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxufVxuIiwiZXhwb3J0IG1vZHVsZSBSVE1hdGgge1xuICAgIGV4cG9ydCBjb25zdCBFUFNJTE9OID0gMC4wMDE7XG59IiwiaW1wb3J0IHsgVmVjdG9yIH0gZnJvbSBcIi4vVmVjdG9yXCI7XG5cbmV4cG9ydCBjbGFzcyBSYXkge1xuICAgIHByaXZhdGUgb3JpZ2luOiBWZWN0b3I7XG4gICAgcHJpdmF0ZSBkaXJlY3Rpb246ICBWZWN0b3I7XG4gICAgcHJpdmF0ZSBkaXN0YW5jZTogbnVtYmVyID0gMDtcbiAgICBwcml2YXRlIGl0ZXJhdGlvbjogbnVtYmVyID0gODtcblxuICAgIGNvbnN0cnVjdG9yIChvcmlnaW46IFZlY3RvciwgZGlyZWN0aW9uOiBWZWN0b3IsIGl0ZXJhdGlvbj86IG51bWJlcikge1xuICAgICAgICB0aGlzLm9yaWdpbiA9IG9yaWdpbjtcbiAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSBWZWN0b3Iubm9ybWFsaXplZChkaXJlY3Rpb24pO1xuXG4gICAgICAgIGlmIChpdGVyYXRpb24pIHtcbiAgICAgICAgICAgIHRoaXMuaXRlcmF0aW9uID0gaXRlcmF0aW9uO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGdldERpcmVjdGlvbiAoKTogVmVjdG9yIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGlyZWN0aW9uO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXREaXN0YW5jZSAoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGlzdGFuY2U7XG4gICAgfVxuXG4gICAgcHVibGljIGdldEl0ZXJhdGlvbiAoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXRlcmF0aW9uO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRPcmlnaW4gKCk6IFZlY3RvciB7XG4gICAgICAgIHJldHVybiB0aGlzLm9yaWdpbjtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0SGl0UG9pbnQgKCk6IFZlY3RvciB7XG4gICAgICAgIHJldHVybiBWZWN0b3IuYWRkKHRoaXMub3JpZ2luLCBWZWN0b3Iuc2NhbGVkKHRoaXMuZGlyZWN0aW9uLCB0aGlzLmRpc3RhbmNlKSk7XG4gICAgfVxuXG4gICAgcHVibGljIHNldERpc3RhbmNlIChkaXN0YW5jZTogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZGlzdGFuY2UgPSBkaXN0YW5jZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc2V0SXRlcmF0aW9uIChpdGVyYXRpb246IG51bWJlcik6IHZvaWQge1xuICAgICAgICB0aGlzLml0ZXJhdGlvbiA9IGl0ZXJhdGlvbjtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDYW1lcmEgfSBmcm9tIFwiLi9DYW1lcmFcIjtcbmltcG9ydCB7IEFic3RyYWN0TGlnaHQgfSBmcm9tIFwiLi9MaWdodHMvQWJzdHJhY3RMaWdodFwiO1xuXG5leHBvcnQgY2xhc3MgU2NlbmUge1xuICAgIHByaXZhdGUgY2FtZXJhOiBDYW1lcmE7XG4gICAgcHJpdmF0ZSBvYmplY3RzOiBhbnlbXSA9IFtdO1xuICAgIHByaXZhdGUgbGlnaHRzOiBBYnN0cmFjdExpZ2h0W10gPSBbXTtcblxuICAgIGNvbnN0cnVjdG9yIChvYmplY3RzOiBhbnkpIHtcbiAgICAgICAgdGhpcy5vYmplY3RzID0gb2JqZWN0cy5vYmplY3RzO1xuICAgICAgICB0aGlzLmNhbWVyYSA9IG9iamVjdHMuY2FtZXJhO1xuICAgICAgICB0aGlzLmxpZ2h0cyA9IG9iamVjdHMubGlnaHRzO1xuICAgIH1cblxuICAgIHB1YmxpYyBhZGRPYmplY3QgKG9iamVjdDogYW55KTogdm9pZCB7XG4gICAgICAgIHRoaXMub2JqZWN0cy5wdXNoKG9iamVjdCk7XG4gICAgfVxuXG4gICAgcHVibGljIGdldENhbWVyYSAoKTogQ2FtZXJhIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2FtZXJhO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRMaWdodHMgKCk6IEFic3RyYWN0TGlnaHRbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxpZ2h0cztcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0T2JqZWN0cyAoKTogYW55W10ge1xuICAgICAgICByZXR1cm4gdGhpcy5vYmplY3RzO1xuICAgIH1cbn1cbiIsIi8vLyA8cmVmZXJlbmNlIG5vLWRlZmF1bHQtbGliPVwidHJ1ZVwiLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJsaWIvbGliLndlYndvcmtlci5kLnRzXCIgLz5cblxuaW1wb3J0IHsgQ2FtZXJhIH0gZnJvbSBcIi4vQ2FtZXJhXCI7XG5pbXBvcnQgeyBDb2xvciB9IGZyb20gXCIuL0NvbG9yL0NvbG9yXCI7XG5pbXBvcnQgeyBSYXkgfSBmcm9tIFwiLi9SYXlcIjtcbmltcG9ydCB7IFJHQkNvbG9yIH0gZnJvbSBcIi4vQ29sb3IvUkdCQ29sb3JcIjtcbmltcG9ydCB7IFJUTWF0aCB9IGZyb20gXCIuL1JUTWF0aFwiO1xuaW1wb3J0IHsgU2NlbmUgfSBmcm9tIFwiLi9TY2VuZVwiO1xuaW1wb3J0IHsgU3BoZXJlIH0gZnJvbSBcIi4vT2JqZWN0cy9TcGhlcmVcIjtcbmltcG9ydCB7IFZlY3RvciB9IGZyb20gXCIuL1ZlY3RvclwiO1xuaW1wb3J0IHsgUGxhbmUgfSBmcm9tIFwiLi9PYmplY3RzL1BsYW5lXCI7XG5pbXBvcnQgeyBBYnN0cmFjdExpZ2h0IH0gZnJvbSBcIi4vTGlnaHRzL0Fic3RyYWN0TGlnaHRcIjtcbmltcG9ydCB7IFNwaGVyaWNhbExpZ2h0IH0gZnJvbSBcIi4vTGlnaHRzL1NwaGVyaWNhbExpZ2h0XCI7XG5pbXBvcnQgeyBNYXRlcmlhbCB9IGZyb20gXCIuL01hdGVyaWFsXCI7XG5pbXBvcnQgeyBQb2x5Z29uIH0gZnJvbSBcIi4vT2JqZWN0cy9Qb2x5Z29uXCI7XG5cbmNsYXNzIFRyYWNlciB7XG4gICAgcHJpdmF0ZSBzY2VuZTogU2NlbmU7XG4gICAgcHJpdmF0ZSBwaXhlbFNhbXBsZXM6IG51bWJlciA9IDQ7XG4gICAgcHJpdmF0ZSBzaGFkb3dTYW1wbGVzOiBudW1iZXIgPSAzNTtcbiAgICBwcml2YXRlIGFvU2FtcGxlczogbnVtYmVyID0gMTAwO1xuICAgIHByaXZhdGUgZ2lTYW1wbGVzOiBudW1iZXIgPSAzNTtcbiAgICBwcml2YXRlIHNjcmVlbldpZHRoOiBudW1iZXIgPSAyNTA7XG4gICAgcHJpdmF0ZSBzY3JlZW5IZWlnaHQ6IG51bWJlciA9IDI1MDtcblxuICAgIHByaXZhdGUgZ2V0Q29sb3IgKHJheTogUmF5LCByZWN1cmNpdmU6IGJvb2xlYW4gPSB0cnVlKTogQ29sb3Ige1xuICAgICAgICBsZXQgaW50ZXJzZWN0ID0gdGhpcy50cmFjZShyYXkpLFxuICAgICAgICAgICAgZGlmZnVzZUNvbG9yOiBDb2xvciA9IG5ldyBDb2xvcihuZXcgUkdCQ29sb3IoMCwgMCwgMCkpLFxuICAgICAgICAgICAgcmVmbGVjdENvbG9yOiBDb2xvciA9IG5ldyBDb2xvcihuZXcgUkdCQ29sb3IoMCwgMCwgMCkpO1xuXG4gICAgICAgIGlmIChpbnRlcnNlY3RbJ293bmVyJ10gPT09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IobmV3IFJHQkNvbG9yKDAsIDAsIDApKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGRpZmZ1c2VDb2xvciA9IHRoaXMuZ2V0RGlmZnVzZUNvbG9yKHJheSwgaW50ZXJzZWN0LCByZWN1cmNpdmUpO1xuXG4gICAgICAgIGlmIChyZWN1cmNpdmUpIHtcbiAgICAgICAgICAgIHJlZmxlY3RDb2xvciA9IHRoaXMuZ2V0UmVmbGVjdGlvbkNvbG9yKHJheSwgaW50ZXJzZWN0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBkaWZmdXNlQ29sb3IuYWRkKHJlZmxlY3RDb2xvcik7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXREaWZmdXNlQ29sb3IgKHJheTogUmF5LCBpbnRlcnNlY3Q6IGFueSwgcmVjdXJzaXZlOiBib29sZWFuID0gdHJ1ZSk6IENvbG9yIHtcbiAgICAgICAgbGV0IGxhbWJDb2xvcjogQ29sb3IsXG4gICAgICAgICAgICByYWRpYW5jZUNvbG9yOiBDb2xvcixcbiAgICAgICAgICAgIGFtYmllbnRPY2NsdXNpb25Db2xvcjogQ29sb3IsXG4gICAgICAgICAgICByYWRpYW5jZVJhbmRvbURpcmVjdGlvbjogVmVjdG9yLFxuICAgICAgICAgICAgcGhvbmdDb2xvcjogQ29sb3IsXG4gICAgICAgICAgICBwaXhlbENvbG9yOiBDb2xvciA9IG5ldyBDb2xvcihuZXcgUkdCQ29sb3IoMCwgMCwgMCkpLFxuICAgICAgICAgICAgbGlnaHREaXJlY3Rpb246IFZlY3RvcixcbiAgICAgICAgICAgIGxpZ2h0UG93ZXI6IG51bWJlcixcbiAgICAgICAgICAgIHJlZmxlY3RQaG9uZ1ZlY3RvckRpcjogVmVjdG9yLFxuICAgICAgICAgICAgbGFtYkNvczogbnVtYmVyLFxuICAgICAgICAgICAgcGhvbmdDb3M6IG51bWJlcixcbiAgICAgICAgICAgIHBob25nOiBudW1iZXI7XG5cbiAgICAgICAgZm9yIChsZXQgbGlnaHQgb2YgdGhpcy5zY2VuZS5nZXRMaWdodHMoKSkge1xuICAgICAgICAgICAgaWYgKGludGVyc2VjdFsnb3duZXJUeXBlJ10gPT09ICdsaWdodCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW50ZXJzZWN0Wydvd25lciddXG4gICAgICAgICAgICAgICAgICAgIC5nZXRNYXRlcmlhbCgpXG4gICAgICAgICAgICAgICAgICAgIC5nZXRDb2xvcigpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsaWdodFBvd2VyID0gdGhpcy5nZXRMaWdodFBvd2VyKGludGVyc2VjdCwgbGlnaHQpO1xuXG4gICAgICAgICAgICBsYW1iQ29sb3IgPSBuZXcgQ29sb3IobmV3IFJHQkNvbG9yKDAsIDAsIDApKTtcbiAgICAgICAgICAgIHJhZGlhbmNlQ29sb3IgPSBuZXcgQ29sb3IobmV3IFJHQkNvbG9yKDAsIDAsIDApKTtcbiAgICAgICAgICAgIGFtYmllbnRPY2NsdXNpb25Db2xvciA9IG5ldyBDb2xvcihuZXcgUkdCQ29sb3IoMCwgMCwgMCkpO1xuICAgICAgICAgICAgcGhvbmdDb2xvciA9IG5ldyBDb2xvcihuZXcgUkdCQ29sb3IoMCwgMCwgMCkpO1xuICAgICAgICAgICAgbGlnaHREaXJlY3Rpb24gPSBWZWN0b3Iubm9ybWFsaXplZChcbiAgICAgICAgICAgICAgICBWZWN0b3Iuc3Vic3RyYWN0KFxuICAgICAgICAgICAgICAgICAgICBpbnRlcnNlY3RbJ3BvaW50J10sXG4gICAgICAgICAgICAgICAgICAgIGxpZ2h0LmdldFBvc2l0aW9uKClcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAvLyBsYW1iZXJ0XG5cbiAgICAgICAgICAgIGxhbWJDb3MgPSAtVmVjdG9yLmRvdChcbiAgICAgICAgICAgICAgICBsaWdodERpcmVjdGlvbixcbiAgICAgICAgICAgICAgICBpbnRlcnNlY3RbJ25vcm1hbCddXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBsYW1iQ29sb3IgPSBsYW1iQ29sb3IuYWRkKFxuICAgICAgICAgICAgICAgIGludGVyc2VjdFsnb3duZXInXVxuICAgICAgICAgICAgICAgICAgICAuZ2V0TWF0ZXJpYWwoKVxuICAgICAgICAgICAgICAgICAgICAuZ2V0Q29sb3IoKVxuICAgICAgICAgICAgICAgICAgICAubXVsdGlwbGUoXG4gICAgICAgICAgICAgICAgICAgICAgICBsaWdodC5nZXRNYXRlcmlhbCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmdldENvbG9yKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2NhbGVkKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWdodFBvd2VyICogbGFtYkNvcyAqIGludGVyc2VjdFsnb3duZXInXS5nZXRNYXRlcmlhbCgpLmdldExhbWJlcnRDb2VmZigpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBsZXQgY29zaW5lV2VpZ2h0ZWREaXJlY3Rpb25Tb3VyY2UgPSAobm9ybWFsOiBWZWN0b3IpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgWGkxID0gTWF0aC5yYW5kb20oKTtcbiAgICAgICAgICAgICAgICBsZXQgWGkyID0gTWF0aC5yYW5kb20oKTtcblxuICAgICAgICAgICAgICAgIGxldCB0aGV0YSA9IE1hdGguYWNvcyhNYXRoLnNxcnQoMSAtIFhpMSkpO1xuICAgICAgICAgICAgICAgIGxldCAgcGhpID0gMiAqIE1hdGguUEkgKiBYaTI7XG5cbiAgICAgICAgICAgICAgICBsZXQgeHMgPSBNYXRoLnNpbih0aGV0YSkgKiBNYXRoLmNvcyhwaGkpO1xuICAgICAgICAgICAgICAgIGxldCB5cyA9IE1hdGguY29zKHRoZXRhKTtcbiAgICAgICAgICAgICAgICBsZXQgenMgPSBNYXRoLnNpbih0aGV0YSkgKiBNYXRoLnNpbihwaGkpO1xuXG4gICAgICAgICAgICAgICAgbGV0IHkgPSBub3JtYWw7XG4gICAgICAgICAgICAgICAgbGV0IGggPSBub3JtYWw7XG4gICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICBNYXRoLmFicyhoLmdldENvb3JkaW5hdGVzKClbJ3gnXSkgPD0gTWF0aC5hYnMoaC5nZXRDb29yZGluYXRlcygpWyd5J10pICYmXG4gICAgICAgICAgICAgICAgICAgIE1hdGguYWJzKGguZ2V0Q29vcmRpbmF0ZXMoKVsneCddKSA8PSBNYXRoLmFicyhoLmdldENvb3JkaW5hdGVzKClbJ3onXSlcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgaCA9IG5ldyBWZWN0b3IoMSwgaC5nZXRDb29yZGluYXRlcygpWyd5J10sIGguZ2V0Q29vcmRpbmF0ZXMoKVsneiddKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFxuICAgICAgICAgICAgICAgICAgICBNYXRoLmFicyhoLmdldENvb3JkaW5hdGVzKClbJ3knXSkgPD0gTWF0aC5hYnMoaC5nZXRDb29yZGluYXRlcygpWyd4J10pICYmXG4gICAgICAgICAgICAgICAgICAgIE1hdGguYWJzKGguZ2V0Q29vcmRpbmF0ZXMoKVsneCddKSA8PSBNYXRoLmFicyhoLmdldENvb3JkaW5hdGVzKClbJ3onXSlcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgaCA9IG5ldyBWZWN0b3IoaC5nZXRDb29yZGluYXRlcygpWyd4J10sIDEsIGguZ2V0Q29vcmRpbmF0ZXMoKVsneiddKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBoID0gbmV3IFZlY3RvcihoLmdldENvb3JkaW5hdGVzKClbJ3gnXSwgaC5nZXRDb29yZGluYXRlcygpWyd5J10sIDEpO1xuICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgbGV0IHggPSBWZWN0b3Iubm9ybWFsaXplZChcbiAgICAgICAgICAgICAgICAgICAgbmV3IFZlY3RvcihcbiAgICAgICAgICAgICAgICAgICAgICAgIGguZ2V0Q29vcmRpbmF0ZXMoKVsneCddICoqIHkuZ2V0Q29vcmRpbmF0ZXMoKVsneCddLFxuICAgICAgICAgICAgICAgICAgICAgICAgaC5nZXRDb29yZGluYXRlcygpWyd5J10gKiogeS5nZXRDb29yZGluYXRlcygpWyd5J10sXG4gICAgICAgICAgICAgICAgICAgICAgICBoLmdldENvb3JkaW5hdGVzKClbJ3onXSAqKiB5LmdldENvb3JkaW5hdGVzKClbJ3onXVxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGxldCB6ID0gVmVjdG9yLm5vcm1hbGl6ZWQoXG4gICAgICAgICAgICAgICAgICAgIG5ldyBWZWN0b3IoXG4gICAgICAgICAgICAgICAgICAgICAgICB4LmdldENvb3JkaW5hdGVzKClbJ3gnXSAqKiB5LmdldENvb3JkaW5hdGVzKClbJ3gnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHguZ2V0Q29vcmRpbmF0ZXMoKVsneSddICoqIHkuZ2V0Q29vcmRpbmF0ZXMoKVsneSddLFxuICAgICAgICAgICAgICAgICAgICAgICAgeC5nZXRDb29yZGluYXRlcygpWyd6J10gKiogeS5nZXRDb29yZGluYXRlcygpWyd6J11cbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICBsZXQgZGlyZWN0aW9uID0gVmVjdG9yLmFkZChcbiAgICAgICAgICAgICAgICAgICAgVmVjdG9yLmFkZChcbiAgICAgICAgICAgICAgICAgICAgICAgIFZlY3Rvci5zY2FsZWQoeCwgeHMpLFxuICAgICAgICAgICAgICAgICAgICAgICAgVmVjdG9yLnNjYWxlZCh5LCB5cylcbiAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgVmVjdG9yLnNjYWxlZCh6LCB6cylcbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFZlY3Rvci5ub3JtYWxpemVkKGRpcmVjdGlvbik7XG5cbiAgICAgICAgICAgICAgICAvKmxldCBiYXNpc1RyYW5zZm9ybTogVmVjdG9yLFxuICAgICAgICAgICAgICAgICAgICBiaXRhbmdlbnQ6IFZlY3RvcixcbiAgICAgICAgICAgICAgICAgICAgdTE6IG51bWJlciA9IE1hdGgucmFuZG9tKCksXG4gICAgICAgICAgICAgICAgICAgIHUyOiBudW1iZXIgPSBNYXRoLnJhbmRvbSgpLFxuICAgICAgICAgICAgICAgICAgICBzaW5fdGhldGE6IG51bWJlciA9IE1hdGguc3FydCh1MSksXG4gICAgICAgICAgICAgICAgICAgIGNvc190aGV0YTogbnVtYmVyID0gTWF0aC5zcXJ0KDEgLSB1MSksXG4gICAgICAgICAgICAgICAgICAgIHBoaTogbnVtYmVyID0gMiAqIE1hdGguUEkgKiB1MixcbiAgICAgICAgICAgICAgICAgICAgZGlyOiBWZWN0b3IgPSBuZXcgVmVjdG9yKFxuICAgICAgICAgICAgICAgICAgICAgICAgc2luX3RoZXRhICogTWF0aC5jb3MocGhpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvc190aGV0YSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpbl90aGV0YSAqIE1hdGguc2luKHBoaSlcbiAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgdGFuZ2VudDogVmVjdG9yO1xuXG4gICAgICAgICAgICAgICAgaWYgKG5vcm1hbC5nZXRDb29yZGluYXRlcygpWyd4J10gPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0YW5nZW50ID0gbmV3IFZlY3RvcigxLCAwLCAwKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0YW5nZW50ID0gVmVjdG9yLm5vcm1hbGl6ZWQoXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgVmVjdG9yKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vcm1hbC5nZXRDb29yZGluYXRlcygpWyd6J10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtbm9ybWFsLmdldENvb3JkaW5hdGVzKClbJ3gnXVxuICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGJpdGFuZ2VudCA9IFZlY3Rvci5jcm9zcyh0YW5nZW50LCBub3JtYWwpO1xuXG4gICAgICAgICAgICAgICAgYmFzaXNUcmFuc2Zvcm0gPSBuZXcgVmVjdG9yKFxuICAgICAgICAgICAgICAgICAgICBWZWN0b3IuZG90KHRhbmdlbnQsIGRpciksXG4gICAgICAgICAgICAgICAgICAgIFZlY3Rvci5kb3Qobm9ybWFsLCBkaXIpLFxuICAgICAgICAgICAgICAgICAgICBWZWN0b3IuZG90KGJpdGFuZ2VudCwgZGlyKVxuICAgICAgICAgICAgICAgICk7Ki9cblxuICAgICAgICAgICAgICAgIC8vcmV0dXJuIFZlY3Rvci5ub3JtYWxpemVkKGJhc2lzVHJhbnNmb3JtKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmIChyZWN1cnNpdmUpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZ2lTYW1wbGVzOyArK2kpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHJhZGlhbmNlSW5SYW5kb21EaXJlY3Rpb246IENvbG9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvc0k6IG51bWJlcjtcblxuICAgICAgICAgICAgICAgICAgICByYWRpYW5jZVJhbmRvbURpcmVjdGlvbiA9IGNvc2luZVdlaWdodGVkRGlyZWN0aW9uU291cmNlKGludGVyc2VjdFsnb3duZXInXS5nZXROb3JtYWwoaW50ZXJzZWN0Wydwb2ludCddKSk7XG4gICAgICAgICAgICAgICAgICAgIHJhZGlhbmNlSW5SYW5kb21EaXJlY3Rpb24gPSB0aGlzLmdldENvbG9yKFxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFJheShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnRlcnNlY3RbJ3BvaW50J10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFkaWFuY2VSYW5kb21EaXJlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICBjb3NJID0gVmVjdG9yLmRvdChcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhZGlhbmNlUmFuZG9tRGlyZWN0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJzZWN0Wydvd25lciddLmdldE5vcm1hbChpbnRlcnNlY3RbJ3BvaW50J10pXG4gICAgICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmFkaWFuY2VDb2xvciA9IHJhZGlhbmNlQ29sb3JcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hZGQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJzZWN0Wydvd25lciddXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5nZXRNYXRlcmlhbCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5nZXRDb2xvcigpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kaXZpZGUoTWF0aC5QSSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm11bHRpcGxlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFkaWFuY2VJblJhbmRvbURpcmVjdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zY2FsZWQoY29zSSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuXG4gICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL2FtYmllbnQgb2NjbHVzaW9uXG4gICAgICAgICAgICBsZXQgYyA9IDA7XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5hb1NhbXBsZXM7IGkrKykge1xuICAgICAgICAgICAgICAgIGxldCBkaXIgPSBjb3NpbmVXZWlnaHRlZERpcmVjdGlvblNvdXJjZShpbnRlcnNlY3RbJ293bmVyJ10uZ2V0Tm9ybWFsKGludGVyc2VjdFsncG9pbnQnXSkpO1xuXG4gICAgICAgICAgICAgICAgbGV0IGFvSW50ZXJzZWN0ID0gdGhpcy50cmFjZShcbiAgICAgICAgICAgICAgICAgICAgbmV3IFJheShcbiAgICAgICAgICAgICAgICAgICAgICAgIGludGVyc2VjdFsncG9pbnQnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpclxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGlmIChhb0ludGVyc2VjdFsncG9pbnQnXSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoYW9JbnRlcnNlY3RbJ2Rpc3RhbmNlJ10gPiAyNTApIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgYysrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBwaG9uZ1xuXG4gICAgICAgICAgICByZWZsZWN0UGhvbmdWZWN0b3JEaXIgPSBWZWN0b3IucmVmbGVjdChcbiAgICAgICAgICAgICAgICBsaWdodERpcmVjdGlvbixcbiAgICAgICAgICAgICAgICBpbnRlcnNlY3RbJ25vcm1hbCddXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcGhvbmdDb3MgPSAtVmVjdG9yLmRvdChyZWZsZWN0UGhvbmdWZWN0b3JEaXIsIHJheS5nZXREaXJlY3Rpb24oKSk7XG5cbiAgICAgICAgICAgIGlmIChwaG9uZ0NvcyA+IDApIHtcbiAgICAgICAgICAgICAgICBwaG9uZyA9IE1hdGgucG93KHBob25nQ29zLCAzNSk7XG4gICAgICAgICAgICAgICAgcGhvbmdDb2xvciA9IHBob25nQ29sb3IuYWRkKFxuICAgICAgICAgICAgICAgICAgICBpbnRlcnNlY3RbJ293bmVyJ11cbiAgICAgICAgICAgICAgICAgICAgICAgIC5nZXRNYXRlcmlhbCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZ2V0Q29sb3IoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm11bHRpcGxlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpZ2h0LmdldE1hdGVyaWFsKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmdldENvbG9yKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNjYWxlZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpZ2h0UG93ZXIgKiBwaG9uZyAqIGludGVyc2VjdFsnb3duZXInXS5nZXRNYXRlcmlhbCgpLmdldFBob25nQ29lZmYoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcGl4ZWxDb2xvciA9IHBpeGVsQ29sb3JcbiAgICAgICAgICAgICAgICAuYWRkKFxuICAgICAgICAgICAgICAgICAgICBsYW1iQ29sb3IuYWRkKFxuICAgICAgICAgICAgICAgICAgICAgICAgcmFkaWFuY2VDb2xvci5kaXZpZGUodGhpcy5naVNhbXBsZXMpXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICApLmFkZChwaG9uZ0NvbG9yKTtcblxuICAgICAgICAgICAgcGl4ZWxDb2xvciA9IHBpeGVsQ29sb3Iuc3Vic3RyYWN0KHBpeGVsQ29sb3Iuc2NhbGVkKDAuMyAqIGMgLyB0aGlzLmFvU2FtcGxlcykpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHBpeGVsQ29sb3I7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRSZWZsZWN0aW9uQ29sb3IgKHJheTogUmF5LCBpbnRlcnNlY3Q6IGFueSk6IGFueSB7XG4gICAgICAgIGxldCByYXlJdGVyYXRpb246IG51bWJlciA9IHJheS5nZXRJdGVyYXRpb24oKSxcbiAgICAgICAgICAgIHJlZmxlY3Rpb25Db2xvcjogQ29sb3IsXG4gICAgICAgICAgICByZWZsZWN0aW9uVmFsdWU6IG51bWJlciA9IGludGVyc2VjdFsnb3duZXInXS5nZXRNYXRlcmlhbCgpLmdldFJlZmxlY3Rpb25WYWx1ZSgpLFxuICAgICAgICAgICAgcmVmbGVjdGVkUmF5OiBWZWN0b3I7XG5cbiAgICAgICAgcmF5LnNldEl0ZXJhdGlvbigtLXJheUl0ZXJhdGlvbik7XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgcmF5SXRlcmF0aW9uID09PSAwIHx8XG4gICAgICAgICAgICByZWZsZWN0aW9uVmFsdWUgPT09IDBcbiAgICAgICAgKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKG5ldyBSR0JDb2xvcigwLCAwLCAwKSk7XG4gICAgICAgIH1cblxuICAgICAgICByZWZsZWN0ZWRSYXkgPSBWZWN0b3IucmVmbGVjdChcbiAgICAgICAgICAgIHJheS5nZXREaXJlY3Rpb24oKSxcbiAgICAgICAgICAgIGludGVyc2VjdFsnbm9ybWFsJ11cbiAgICAgICAgKTtcblxuICAgICAgICByZWZsZWN0aW9uQ29sb3IgPSB0aGlzLmdldENvbG9yKFxuICAgICAgICAgICAgbmV3IFJheShpbnRlcnNlY3RbJ3BvaW50J10sIHJlZmxlY3RlZFJheSwgcmF5SXRlcmF0aW9uKVxuICAgICAgICApLnNjYWxlZChyZWZsZWN0aW9uVmFsdWUpO1xuXG4gICAgICAgIHJldHVybiByZWZsZWN0aW9uQ29sb3I7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRQZXJzcGVjdGl2ZVZlY3RvciAoeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcbiAgICAgICAgbGV0IGNhbWVyYTogQ2FtZXJhID0gdGhpcy5zY2VuZS5nZXRDYW1lcmEoKTtcblxuICAgICAgICByZXR1cm4gVmVjdG9yLm5vcm1hbGl6ZWQoXG4gICAgICAgICAgICBWZWN0b3IuYWRkKFxuICAgICAgICAgICAgICAgIGNhbWVyYS5nZXRGb3J3YXJkVmVjdG9yKCksXG4gICAgICAgICAgICAgICAgVmVjdG9yLmFkZChcbiAgICAgICAgICAgICAgICAgICAgVmVjdG9yLnNjYWxlZChcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbWVyYS5nZXRSaWdodFZlY3RvcigpLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2FtZXJhLnJlY2VudGVyWCh4KVxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICBWZWN0b3Iuc2NhbGVkKFxuICAgICAgICAgICAgICAgICAgICAgICAgY2FtZXJhLmdldFVwVmVjdG9yKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBjYW1lcmEucmVjZW50ZXJZKHkpXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRMaWdodFBvd2VyIChpbnRlcnNlY3Q6IGFueSwgbGlnaHQ6IEFic3RyYWN0TGlnaHQpOiBudW1iZXIge1xuICAgICAgICBsZXQgbGlnaHRQb3dlciA9IGxpZ2h0LmdldFBvd2VyKCksXG4gICAgICAgICAgICBsaWdodFJhbmRvbVBvaW50OiBWZWN0b3IsXG4gICAgICAgICAgICBsaWdodFJheTogYW55LFxuICAgICAgICAgICAgcmVzdWx0UG93ZXI6IG51bWJlciA9IDA7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnNoYWRvd1NhbXBsZXM7IGkrKykge1xuICAgICAgICAgICAgbGlnaHRSYW5kb21Qb2ludCA9IGxpZ2h0LmdldFJhbmRvbVBvaW50KCk7XG5cbiAgICAgICAgICAgIGxpZ2h0UmF5ID0gdGhpcy50cmFjZShcbiAgICAgICAgICAgICAgICBuZXcgUmF5KFxuICAgICAgICAgICAgICAgICAgICBpbnRlcnNlY3RbJ3BvaW50J10sXG4gICAgICAgICAgICAgICAgICAgIFZlY3Rvci5zdWJzdHJhY3QoXG4gICAgICAgICAgICAgICAgICAgICAgICBWZWN0b3Iuc3Vic3RyYWN0KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpZ2h0LmdldFBvc2l0aW9uKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlnaHRSYW5kb21Qb2ludFxuICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGludGVyc2VjdFsncG9pbnQnXVxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgaWYgKGxpZ2h0UmF5Wydwb2ludCddID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChsaWdodFJheVsnb3duZXInXSAhPT0gbGlnaHQpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmVzdWx0UG93ZXIgKz0gKFxuICAgICAgICAgICAgICAgIGxpZ2h0UG93ZXIgLVxuICAgICAgICAgICAgICAgIChcbiAgICAgICAgICAgICAgICAgICAgVmVjdG9yLnN1YnN0cmFjdChcbiAgICAgICAgICAgICAgICAgICAgICAgIFZlY3Rvci5zdWJzdHJhY3QoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlnaHQuZ2V0UG9zaXRpb24oKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWdodFJhbmRvbVBvaW50XG4gICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJzZWN0Wydwb2ludCddXG4gICAgICAgICAgICAgICAgICAgICkuZ2V0TGVuZ3RoKCkgKiAobGlnaHRQb3dlciAvIGxpZ2h0LmdldEZhZGVSYWRpdXMoKSlcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICApIC8gdGhpcy5zaGFkb3dTYW1wbGVzO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdFBvd2VyO1xuICAgIH1cblxuICAgIHByaXZhdGUgdHJhY2UgKHJheTogUmF5KToge2Rpc3RhbmNlOiBudW1iZXIsIHBvaW50OiBWZWN0b3IsIG93bmVyOiBhbnksIG93bmVyVHlwZTogc3RyaW5nfSB7XG4gICAgICAgIGxldCByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgZGlzdGFuY2U6IDAsXG4gICAgICAgICAgICAgICAgcG9pbnQ6IG51bGwsXG4gICAgICAgICAgICAgICAgbm9ybWFsOiBudWxsLFxuICAgICAgICAgICAgICAgIG93bmVyOiBudWxsLFxuICAgICAgICAgICAgICAgIG93bmVyVHlwZTogbnVsbFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGludGVyc2VjdERhdGE6IGFueSxcbiAgICAgICAgICAgIHNjZW5lT2JqZWN0c1dpdGhMaWdodHM6IGFueVtdID0gdGhpcy5zY2VuZS5nZXRPYmplY3RzKCkuY29uY2F0KHRoaXMuc2NlbmUuZ2V0TGlnaHRzKCkpO1xuXG4gICAgICAgIGZvciAobGV0IG9iamVjdCBvZiBzY2VuZU9iamVjdHNXaXRoTGlnaHRzKSB7XG4gICAgICAgICAgICBpbnRlcnNlY3REYXRhID0gb2JqZWN0LmdldEludGVyc2VjdERhdGEocmF5KTtcblxuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgIGludGVyc2VjdERhdGEgJiZcbiAgICAgICAgICAgICAgICBpbnRlcnNlY3REYXRhWydkaXN0YW5jZSddID4gMCAmJlxuICAgICAgICAgICAgICAgIChcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0Wydvd25lciddID09PSBudWxsIHx8XG4gICAgICAgICAgICAgICAgICAgIGludGVyc2VjdERhdGFbJ2Rpc3RhbmNlJ10gPCByZXN1bHRbJ2Rpc3RhbmNlJ11cbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICByZXN1bHRbJ2Rpc3RhbmNlJ10gPSBpbnRlcnNlY3REYXRhWydkaXN0YW5jZSddO1xuICAgICAgICAgICAgICAgIHJlc3VsdFsncG9pbnQnXSA9IGludGVyc2VjdERhdGFbJ3BvaW50J107XG4gICAgICAgICAgICAgICAgcmVzdWx0Wydvd25lciddID0gb2JqZWN0O1xuICAgICAgICAgICAgICAgIHJlc3VsdFsnb3duZXJUeXBlJ10gPSBvYmplY3QuZ2V0VHlwZSgpO1xuICAgICAgICAgICAgICAgIHJlc3VsdFsnbm9ybWFsJ10gPSByZXN1bHRbJ293bmVyJ10uZ2V0Tm9ybWFsKHJlc3VsdFsncG9pbnQnXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIHB1YmxpYyByZW5kZXIgKHNjcmVlbldpZHRoOiBudW1iZXIsIHNjcmVlbkhlaWdodDogbnVtYmVyLCB4OiBudW1iZXIsIHk6IG51bWJlcik6IHZvaWQge1xuICAgICAgICBjb25zdCByYW5kb011bHRpcGxpZXIgPSAwLjU7XG5cbiAgICAgICAgbGV0IGNvbG9yOiBDb2xvcixcbiAgICAgICAgICAgIHJhbmQ6IG51bWJlcixcbiAgICAgICAgICAgIHJheTogUmF5LFxuICAgICAgICAgICAgcmdiQ29sb3I6IHtcbiAgICAgICAgICAgICAgICByZWQ6IG51bWJlcixcbiAgICAgICAgICAgICAgICBncmVlbjogbnVtYmVyLFxuICAgICAgICAgICAgICAgIGJsdWU6IG51bWJlclxuICAgICAgICAgICAgfTtcblxuICAgICAgICB0aGlzLnNjcmVlbldpZHRoID0gc2NyZWVuV2lkdGg7XG4gICAgICAgIHRoaXMuc2NyZWVuSGVpZ2h0ID0gc2NyZWVuSGVpZ2h0O1xuXG4gICAgICAgIGNvbG9yID0gbmV3IENvbG9yKG5ldyBSR0JDb2xvcigwLCAwLCAwKSk7XG5cbiAgICAgICAgZm9yIChsZXQgaXRlciA9IDA7IGl0ZXIgPCB0aGlzLnBpeGVsU2FtcGxlczsgaXRlcisrKSB7XG4gICAgICAgICAgICByYW5kID0gMDtcblxuICAgICAgICAgICAgaWYgKHRoaXMucGl4ZWxTYW1wbGVzID4gMSkge1xuICAgICAgICAgICAgICAgIGlmIChpdGVyICUgMikge1xuICAgICAgICAgICAgICAgICAgICByYW5kICs9IE1hdGgucmFuZG9tKCkgKiByYW5kb011bHRpcGxpZXI7XG4gICAgICAgICAgICAgICAgfSAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJhbmQgLT0gTWF0aC5yYW5kb20oKSAqIHJhbmRvTXVsdGlwbGllcjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJheSA9IG5ldyBSYXkoXG4gICAgICAgICAgICAgICAgdGhpcy5zY2VuZS5nZXRDYW1lcmEoKS5nZXRQb3NpdGlvbigpLFxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0UGVyc3BlY3RpdmVWZWN0b3IoeCArIHJhbmQsIHkgKyByYW5kKVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY29sb3IgPSBjb2xvci5hZGQodGhpcy5nZXRDb2xvcihyYXkpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbG9yID0gY29sb3IuZGl2aWRlKHRoaXMucGl4ZWxTYW1wbGVzKTtcblxuICAgICAgICBmb3IgKGxldCBjb21wb25lbnQgaW4gY29sb3IpIHtcbiAgICAgICAgICAgIGNvbG9yW2NvbXBvbmVudF0gPSBDb2xvci5zUkdCRW5jb2RlKGNvbG9yW2NvbXBvbmVudF0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmdiQ29sb3IgPSBDb2xvci50b1JHQihjb2xvcik7XG5cbiAgICAgICAgc2VsZi5wb3N0TWVzc2FnZShbeCwgeSwgcmdiQ29sb3IucmVkLCByZ2JDb2xvci5ncmVlbiwgcmdiQ29sb3IuYmx1ZV0pO1xuICAgIH1cblxuICAgIHB1YmxpYyBzZXRTY2VuZSAoc2NlbmU6IFNjZW5lKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc2NlbmUgPSBzY2VuZTtcbiAgICB9XG59XG5cbm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgdmFyIGRhdGEgPSBtZXNzYWdlLmRhdGE7XG5cbiAgICBpZiAodHlwZW9mKGRhdGEpID09ICdzdHJpbmcnKSB7XG4gICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKCdbJytkYXRhKyddJyk7XG4gICAgfVxuXG4gICAgbGV0IHRyYWNlciA9IG5ldyBUcmFjZXIoKTtcblxuICAgIHRyYWNlci5zZXRTY2VuZShcbiAgICAgICAgbmV3IFNjZW5lKHtcbiAgICAgICAgICAgIGNhbWVyYTogbmV3IENhbWVyYShcbiAgICAgICAgICAgICAgICBuZXcgVmVjdG9yKDAsIDAsIC02OTkpLFxuICAgICAgICAgICAgICAgIG5ldyBWZWN0b3IoMCwgMCwgMSksXG4gICAgICAgICAgICAgICAgZGF0YVswXSxcbiAgICAgICAgICAgICAgICBkYXRhWzFdXG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgbGlnaHRzOiBbXG4gICAgICAgICAgICAgICAgbmV3IFNwaGVyaWNhbExpZ2h0KG5ldyBWZWN0b3IgKDAsIDY0MCwgMCksIDAuNywgNTApXG4gICAgICAgICAgICAgICAgICAgIC5zZXRNYXRlcmlhbChuZXcgTWF0ZXJpYWwobmV3IENvbG9yKG5ldyBSR0JDb2xvcigyNTUsIDI1NSwgMjU1KSkpKSxcbiAgICAgICAgICAgICAgICBuZXcgU3BoZXJpY2FsTGlnaHQobmV3IFZlY3RvciAoMCwgMCwgMCksIDAuNywgMTUwKVxuICAgICAgICAgICAgICAgICAgICAuc2V0TWF0ZXJpYWwobmV3IE1hdGVyaWFsKG5ldyBDb2xvcihuZXcgUkdCQ29sb3IoMjU1LCAyMzUsIDIwMCkpKSlcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBvYmplY3RzOiBbXG4gICAgICAgICAgICAgICAgLy9uZXcgUGxhbmUobmV3IFZlY3RvcigwLCAxLCAwKSwgLTQwMCkuc2V0TWF0ZXJpYWwobmV3IE1hdGVyaWFsKG5ldyBDb2xvcihuZXcgUkdCQ29sb3IoMTE1LCAxMTUsIDExNSkpLCAwKSksXG4gICAgICAgICAgICAgICAgLy8gYm90dG9tIHBsYW5lXG4gICAgICAgICAgICAgICAgbmV3IFBvbHlnb24oXG4gICAgICAgICAgICAgICAgICAgIG5ldyBWZWN0b3IoLTcwMCwgLTcwMCwgLTcwMCksXG4gICAgICAgICAgICAgICAgICAgIG5ldyBWZWN0b3IoNzAwLCAtNzAwLCAtNzAwKSxcbiAgICAgICAgICAgICAgICAgICAgbmV3IFZlY3Rvcig3MDAsIC03MDAsIDcwMCksXG4gICAgICAgICAgICAgICAgICAgIG5ldyBWZWN0b3IoLTcwMCwgLTcwMCwgNzAwKVxuICAgICAgICAgICAgICAgICkuc2V0TWF0ZXJpYWwobmV3IE1hdGVyaWFsKG5ldyBDb2xvcihuZXcgUkdCQ29sb3IoMjU1LCAyNTUsIDI1NSkpLCAwKS5zZXRMYW1iZXJ0Q29lZmYoMSkpLFxuICAgICAgICAgICAgICAgIC8vIGZyb250IHBsYW5lXG4gICAgICAgICAgICAgICAgbmV3IFBvbHlnb24oXG4gICAgICAgICAgICAgICAgICAgIG5ldyBWZWN0b3IoLTcwMCwgLTcwMCwgNzAwKSxcbiAgICAgICAgICAgICAgICAgICAgbmV3IFZlY3Rvcig3MDAsIC03MDAsIDcwMCksXG4gICAgICAgICAgICAgICAgICAgIG5ldyBWZWN0b3IoNzAwLCA3MDAsIDcwMCksXG4gICAgICAgICAgICAgICAgICAgIG5ldyBWZWN0b3IoLTcwMCwgNzAwLCA3MDApXG4gICAgICAgICAgICAgICAgKS5zZXRNYXRlcmlhbChuZXcgTWF0ZXJpYWwobmV3IENvbG9yKG5ldyBSR0JDb2xvcigyNTUsIDI1NSwgMjU1KSksIDApLnNldExhbWJlcnRDb2VmZigxKSksXG4gICAgICAgICAgICAgICAgLy8gdG9wIHBsYW5lXG4gICAgICAgICAgICAgICAgbmV3IFBvbHlnb24oXG4gICAgICAgICAgICAgICAgICAgIG5ldyBWZWN0b3IoLTcwMCwgNzAwLCAtNzAwKSxcbiAgICAgICAgICAgICAgICAgICAgbmV3IFZlY3RvcigtNzAwLCA3MDAsIDcwMCksXG4gICAgICAgICAgICAgICAgICAgIG5ldyBWZWN0b3IoNzAwLCA3MDAsIDcwMCksXG4gICAgICAgICAgICAgICAgICAgIG5ldyBWZWN0b3IoNzAwLCA3MDAsIC03MDApXG4gICAgICAgICAgICAgICAgKS5zZXRNYXRlcmlhbChuZXcgTWF0ZXJpYWwobmV3IENvbG9yKG5ldyBSR0JDb2xvcigyNTUsIDI1NSwgMjU1KSksIDApLnNldExhbWJlcnRDb2VmZigxKSksXG4gICAgICAgICAgICAgICAgLy9yaWdodCBwbGFuZVxuICAgICAgICAgICAgICAgIG5ldyBQb2x5Z29uKFxuICAgICAgICAgICAgICAgICAgICBuZXcgVmVjdG9yKDcwMCwgLTcwMCwgNzAwKSxcbiAgICAgICAgICAgICAgICAgICAgbmV3IFZlY3Rvcig3MDAsIC03MDAsIC03MDApLFxuICAgICAgICAgICAgICAgICAgICBuZXcgVmVjdG9yKDcwMCwgNzAwLCAtNzAwKSxcbiAgICAgICAgICAgICAgICAgICAgbmV3IFZlY3Rvcig3MDAsIDcwMCwgNzAwKVxuICAgICAgICAgICAgICAgICkuc2V0TWF0ZXJpYWwobmV3IE1hdGVyaWFsKG5ldyBDb2xvcihuZXcgUkdCQ29sb3IoNzksIDE2NiwgMjQyKSksIDApLnNldExhbWJlcnRDb2VmZigxKSksXG4gICAgICAgICAgICAgICAgLy9sZWZ0IHBsYW5lXG4gICAgICAgICAgICAgICAgbmV3IFBvbHlnb24oXG4gICAgICAgICAgICAgICAgICAgIG5ldyBWZWN0b3IoLTcwMCwgLTcwMCwgLTcwMCksXG4gICAgICAgICAgICAgICAgICAgIG5ldyBWZWN0b3IoLTcwMCwgLTcwMCwgNzAwKSxcbiAgICAgICAgICAgICAgICAgICAgbmV3IFZlY3RvcigtNzAwLCA3MDAsIDcwMCksXG4gICAgICAgICAgICAgICAgICAgIG5ldyBWZWN0b3IoLTcwMCwgNzAwLCAtNzAwKVxuICAgICAgICAgICAgICAgICkuc2V0TWF0ZXJpYWwobmV3IE1hdGVyaWFsKG5ldyBDb2xvcihuZXcgUkdCQ29sb3IoMjQ1LCAxMzAsIDEzMCkpLCAwKS5zZXRMYW1iZXJ0Q29lZmYoMSkpLFxuICAgICAgICAgICAgICAgIC8vIGJhY2sgcGxhbmVcbiAgICAgICAgICAgICAgICBuZXcgUG9seWdvbihcbiAgICAgICAgICAgICAgICAgICAgbmV3IFZlY3Rvcig3MDAsIC03MDAsIC03MDApLFxuICAgICAgICAgICAgICAgICAgICBuZXcgVmVjdG9yKC03MDAsIC03MDAsIC03MDApLFxuICAgICAgICAgICAgICAgICAgICBuZXcgVmVjdG9yKC03MDAsIDcwMCwgLTcwMCksXG4gICAgICAgICAgICAgICAgICAgIG5ldyBWZWN0b3IoNzAwLCA3MDAsIC03MDApXG4gICAgICAgICAgICAgICAgKS5zZXRNYXRlcmlhbChuZXcgTWF0ZXJpYWwobmV3IENvbG9yKG5ldyBSR0JDb2xvcigwLCAwLCAwKSksIDApLnNldExhbWJlcnRDb2VmZigxKSksXG4gICAgICAgICAgICAgICAgbmV3IFNwaGVyZShuZXcgVmVjdG9yKC0yNTAsIC01MDAsIDQ1MCksIDIwMClcbiAgICAgICAgICAgICAgICAgICAgLnNldE1hdGVyaWFsKG5ldyBNYXRlcmlhbChuZXcgQ29sb3IobmV3IFJHQkNvbG9yKDAsIDAsIDApKSwgMSkpLFxuICAgICAgICAgICAgICAgIG5ldyBTcGhlcmUobmV3IFZlY3RvcigyNTAsIC01MDAsIDQwMCksIDIwMClcbiAgICAgICAgICAgICAgICAgICAgLnNldE1hdGVyaWFsKG5ldyBNYXRlcmlhbChuZXcgQ29sb3IobmV3IFJHQkNvbG9yKDAsIDI1NSwgMCkpLCAwKSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSlcbiAgICApO1xuXG4gICAgdHJhY2VyLnJlbmRlcihkYXRhWzBdLCBkYXRhWzFdLCBkYXRhWzJdLCBkYXRhWzNdKTtcbn07IiwiZXhwb3J0IGNsYXNzIFZlY3RvciB7XG4gICAgcHJpdmF0ZSB4OiBudW1iZXI7XG4gICAgcHJpdmF0ZSB5OiBudW1iZXI7XG4gICAgcHJpdmF0ZSB6OiBudW1iZXI7XG5cbiAgICBjb25zdHJ1Y3RvciAoeDogbnVtYmVyLCB5OiBudW1iZXIsIHo6IG51bWJlcikge1xuICAgICAgICB0aGlzLnggPSB4O1xuICAgICAgICB0aGlzLnkgPSB5O1xuICAgICAgICB0aGlzLnogPSB6O1xuICAgIH1cblxuICAgIGdldENvb3JkaW5hdGVzICgpOiB7eDogbnVtYmVyLCB5OiBudW1iZXIsIHo6IG51bWJlcn0ge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgeDogdGhpcy54LFxuICAgICAgICAgICAgeTogdGhpcy55LFxuICAgICAgICAgICAgejogdGhpcy56XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcHVibGljIGFzQXJyYXkgKCk6IG51bWJlcltdIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHRoaXMueCxcbiAgICAgICAgICAgIHRoaXMueSxcbiAgICAgICAgICAgIHRoaXMuelxuICAgICAgICBdO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRMZW5ndGggKCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiBNYXRoLnNxcnQodGhpcy54ICoqIDIgKyB0aGlzLnkgKiogMiArIHRoaXMueiAqKiAyKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIGFkZCAodmVjdG9yMTogVmVjdG9yLCB2ZWN0b3IyOiBWZWN0b3IpOiBWZWN0b3Ige1xuICAgICAgICByZXR1cm4gbmV3IFZlY3Rvcih2ZWN0b3IxLnggKyB2ZWN0b3IyLngsIHZlY3RvcjEueSArIHZlY3RvcjIueSwgdmVjdG9yMS56ICsgdmVjdG9yMi56KTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIHN1YnN0cmFjdCAodmVjdG9yMTogVmVjdG9yLCB2ZWN0b3IyOiBWZWN0b3IpOiBWZWN0b3Ige1xuICAgICAgICByZXR1cm4gbmV3IFZlY3Rvcih2ZWN0b3IxLnggLSB2ZWN0b3IyLngsIHZlY3RvcjEueSAtIHZlY3RvcjIueSwgdmVjdG9yMS56IC0gdmVjdG9yMi56KTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIHNjYWxlZCAodmVjdG9yOiBWZWN0b3IsIG11bHRpcGxpZXI6IG51bWJlcik6IFZlY3RvciB7XG4gICAgICAgIHJldHVybiBuZXcgVmVjdG9yKHZlY3Rvci54ICogbXVsdGlwbGllciwgdmVjdG9yLnkgKiBtdWx0aXBsaWVyLCB2ZWN0b3IueiAqIG11bHRpcGxpZXIpO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgY3Jvc3MgKHZlY3RvcjE6IFZlY3RvciwgdmVjdG9yMjogVmVjdG9yKTogVmVjdG9yIHtcbiAgICAgICAgcmV0dXJuIG5ldyBWZWN0b3IoXG4gICAgICAgICAgICB2ZWN0b3IxLnkgKiB2ZWN0b3IyLnogLSB2ZWN0b3IxLnogKiB2ZWN0b3IyLnksXG4gICAgICAgICAgICB2ZWN0b3IxLnogKiB2ZWN0b3IyLnggLSB2ZWN0b3IxLnggKiB2ZWN0b3IyLnosXG4gICAgICAgICAgICB2ZWN0b3IxLnggKiB2ZWN0b3IyLnkgLSB2ZWN0b3IxLnkgKiB2ZWN0b3IyLnhcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIGludmVyc2UgKHZlY3RvcjogVmVjdG9yKTogVmVjdG9yIHtcbiAgICAgICAgcmV0dXJuIFZlY3Rvci5zY2FsZWQodmVjdG9yLCAtMSk7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBkb3QgKHZlY3RvcjE6IFZlY3RvciwgdmVjdG9yMjogVmVjdG9yKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHZlY3RvcjEueCAqIHZlY3RvcjIueCArIHZlY3RvcjEueSAqIHZlY3RvcjIueSArIHZlY3RvcjEueiAqIHZlY3RvcjIuejtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIG5vcm1hbGl6ZWQgKHZlY3RvcjogVmVjdG9yKTogVmVjdG9yIHtcbiAgICAgICAgcmV0dXJuIFZlY3Rvci5zY2FsZWQodmVjdG9yLCAxIC8gdmVjdG9yLmdldExlbmd0aCgpKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIHJlZmxlY3QgKHZlY3RvcjogVmVjdG9yLCBub3JtYWw6IFZlY3Rvcik6IFZlY3RvciB7XG4gICAgICAgIGxldCBmID0gMiAqIFZlY3Rvci5kb3QodmVjdG9yLCBub3JtYWwpO1xuXG4gICAgICAgIHJldHVybiBWZWN0b3Iuc3Vic3RyYWN0KFxuICAgICAgICAgICAgdmVjdG9yLFxuICAgICAgICAgICAgVmVjdG9yLnNjYWxlZChub3JtYWwsIGYpXG4gICAgICAgICk7XG4gICAgfVxufVxuIl19
