var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},RTMath_1=require("../RTMath"),AbstractObject_1=require("./AbstractObject"),Color_1=require("../Color/Color"),Material_1=require("../Material"),RGBColor_1=require("../Color/RGBColor"),Vector_1=require("../Vector"),Sphere=function(t){function e(e,r){t.call(this),this.material=new Material_1.Material(new Color_1.Color(new RGBColor_1.RGBColor(255,0,0)),0),this.type="surface",this.center=e,this.radius=r}return __extends(e,t),e.prototype.getIntersectData=function(t){var e,r,o,i,a,c,n,s=Vector_1.Vector.substract(t.getOrigin(),this.center),h=Vector_1.Vector.dot(s,t.getDirection()),u=Vector_1.Vector.dot(s,s)-Math.pow(this.radius,2),l=Math.pow(h,2)-u;if(!(h>0||0>l||l>=0&&(e=-h+Math.sqrt(l),r=-h-Math.sqrt(l),o=Math.min(e,r),i=Math.max(e,r),a=o>RTMath_1.RTMath.EPSILON?o:i,a<RTMath_1.RTMath.EPSILON)))return c=Vector_1.Vector.add(Vector_1.Vector.scaled(t.getDirection(),a),t.getOrigin()),n=Vector_1.Vector.substract(c,t.getOrigin()).getLength(),{point:c,distance:n}},e.prototype.getMaterial=function(){return this.material},e.prototype.getNormal=function(t){return Vector_1.Vector.normalized(Vector_1.Vector.scaled(Vector_1.Vector.substract(t,this.center),1/this.radius))},e.prototype.getType=function(){return this.type},e.prototype.setMaterial=function(t){return this.material=t,this},e}(AbstractObject_1.AbstractObject);exports.Sphere=Sphere;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk9iamVjdHMvU3BoZXJlLmpzIiwiT2JqZWN0cy9TcGhlcmUudHMiXSwibmFtZXMiOlsiX19leHRlbmRzIiwidGhpcyIsImQiLCJiIiwiX18iLCJjb25zdHJ1Y3RvciIsInAiLCJoYXNPd25Qcm9wZXJ0eSIsInByb3RvdHlwZSIsIk9iamVjdCIsImNyZWF0ZSIsIlJUTWF0aF8xIiwicmVxdWlyZSIsIkFic3RyYWN0T2JqZWN0XzEiLCJDb2xvcl8xIiwiTWF0ZXJpYWxfMSIsIlJHQkNvbG9yXzEiLCJWZWN0b3JfMSIsIlNwaGVyZSIsIl9zdXBlciIsIlNwaGVyZS5jb25zdHJ1Y3RvciIsIlNwaGVyZS5nZXRJbnRlcnNlY3REYXRhIiwiU3BoZXJlLmdldE1hdGVyaWFsIiwiU3BoZXJlLmdldE5vcm1hbCIsIlNwaGVyZS5nZXRUeXBlIiwiU3BoZXJlLnNldE1hdGVyaWFsIiwiQWJzdHJhY3RPYmplY3QiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQSxHQUFJQSxXQUFhQyxNQUFRQSxLQUFLRCxXQUFjLFNBQVVFLEVBQUdDLEdBRXJELFFBQVNDLEtBQU9ILEtBQUtJLFlBQWNILEVBRG5DLElBQUssR0FBSUksS0FBS0gsR0FBT0EsRUFBRUksZUFBZUQsS0FBSUosRUFBRUksR0FBS0gsRUFBRUcsR0FFbkRKLEdBQUVNLFVBQWtCLE9BQU5MLEVBQWFNLE9BQU9DLE9BQU9QLElBQU1DLEVBQUdJLFVBQVlMLEVBQUVLLFVBQVcsR0FBSUosS0NIbkZPLFNBQUFDLFFBQXVCLGFBQ3ZCQyxpQkFBQUQsUUFBK0Isb0JBQy9CRSxRQUFBRixRQUFzQixrQkFDdEJHLFdBQUFILFFBQXlCLGVBRXpCSSxXQUFBSixRQUF5QixxQkFDekJLLFNBQUFMLFFBQXVCLGFBRXZCTSxPQUFBLFNBQUFDLEdBTUlELFFBQUFBLEdBQWFBLEVBQWdCQSxHQUN6QkUsRUFBQUEsS0FBQUEsTUFKSUEsS0FBQUEsU0FBcUJBLEdBQUlBLFlBQUFBLFNBQVNBLEdBQUlBLFNBQUFBLE1BQU1BLEdBQUlBLFlBQUFBLFNBQVNBLElBQUtBLEVBQUdBLElBQUtBLEdBQ3RFQSxLQUFBQSxLQUFlQSxVQUtuQkEsS0FBS0EsT0FBU0EsRUFDZEEsS0FBS0EsT0FBU0EsRUEwRXRCRixNQXBGNEJBLFdBQUFBLEVBQUFBLEdBYWpCQSxFQUFBQSxVQUFBQSxpQkFBUEEsU0FBeUJBLEdBQ3JCRyxHQUlJQSxHQUNBQSxFQUNBQSxFQUNBQSxFQUNBQSxFQUNBQSxFQUNBQSxFQVZBQSxFQUFJQSxTQUFBQSxPQUFPQSxVQUFVQSxFQUFJQSxZQUFhQSxLQUFLQSxRQUMzQ0EsRUFBWUEsU0FBQUEsT0FBT0EsSUFBSUEsRUFBR0EsRUFBSUEsZ0JBQzlCQSxFQUFZQSxTQUFBQSxPQUFPQSxJQUFJQSxFQUFHQSxHQUFLQSxLQUFBQSxJQUFBQSxLQUFLQSxPQUFVQSxHQUM5Q0EsRUFBWUEsS0FBQUEsSUFBQUEsRUFBS0EsR0FBSUEsQ0FTekJBLE1BQUlBLEVBQUlBLEdBQVNBLEVBQUpBLEdBSVRBLEdBQUtBLElBQ0xBLEdBQU1BLEVBQUlBLEtBQUtBLEtBQUtBLEdBQ3BCQSxHQUFNQSxFQUFJQSxLQUFLQSxLQUFLQSxHQUNwQkEsRUFBT0EsS0FBS0EsSUFBSUEsRUFBSUEsR0FDcEJBLEVBQU9BLEtBQUtBLElBQUlBLEVBQUlBLEdBR2hCQSxFQURBQSxFQUFPQSxTQUFBQSxPQUFPQSxRQUNNQSxFQUVBQSxFQUdwQkEsRUFBb0JBLFNBQUFBLE9BQU9BLFVBY25DQSxNQVRBQSxHQUFRQSxTQUFBQSxPQUFPQSxJQUNYQSxTQUFBQSxPQUFPQSxPQUFPQSxFQUFJQSxlQUFnQkEsR0FDbENBLEVBQUlBLGFBRVJBLEVBQVdBLFNBQUFBLE9BQU9BLFVBQ2RBLEVBQ0FBLEVBQUlBLGFBQ05BLGFBR0VBLE1BQUFBLEVBQ0FBLFNBQUFBLElBSURILEVBQUFBLFVBQUFBLFlBQVBBLFdBQ0lJLE1BQU9BLE1BQUtBLFVBR1RKLEVBQUFBLFVBQUFBLFVBQVBBLFNBQWtCQSxHQUNkSyxNQUFPQSxVQUFBQSxPQUFPQSxXQUNWQSxTQUFBQSxPQUFPQSxPQUNIQSxTQUFBQSxPQUFPQSxVQUFVQSxFQUFPQSxLQUFLQSxRQUM3QkEsRUFBSUEsS0FBS0EsVUFLZEwsRUFBQUEsVUFBQUEsUUFBUEEsV0FDSU0sTUFBT0EsTUFBS0EsTUFHVE4sRUFBQUEsVUFBQUEsWUFBUEEsU0FBb0JBLEdBR2hCTyxNQUZBQSxNQUFLQSxTQUFXQSxFQUVUQSxNQUVmUCxHQXBGNEJMLGlCQUFBYSxlQUFmQyxTQUFBVCxPQUFNQSIsImZpbGUiOiJPYmplY3RzL1NwaGVyZS5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgZnVuY3Rpb24gKGQsIGIpIHtcbiAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTtcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG59O1xudmFyIFJUTWF0aF8xID0gcmVxdWlyZShcIi4uL1JUTWF0aFwiKTtcbnZhciBBYnN0cmFjdE9iamVjdF8xID0gcmVxdWlyZShcIi4vQWJzdHJhY3RPYmplY3RcIik7XG52YXIgQ29sb3JfMSA9IHJlcXVpcmUoXCIuLi9Db2xvci9Db2xvclwiKTtcbnZhciBNYXRlcmlhbF8xID0gcmVxdWlyZShcIi4uL01hdGVyaWFsXCIpO1xudmFyIFJHQkNvbG9yXzEgPSByZXF1aXJlKFwiLi4vQ29sb3IvUkdCQ29sb3JcIik7XG52YXIgVmVjdG9yXzEgPSByZXF1aXJlKFwiLi4vVmVjdG9yXCIpO1xudmFyIFNwaGVyZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFNwaGVyZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTcGhlcmUoY2VudGVyLCByYWRpdXMpIHtcbiAgICAgICAgX3N1cGVyLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMubWF0ZXJpYWwgPSBuZXcgTWF0ZXJpYWxfMS5NYXRlcmlhbChuZXcgQ29sb3JfMS5Db2xvcihuZXcgUkdCQ29sb3JfMS5SR0JDb2xvcigyNTUsIDAsIDApKSwgMCk7XG4gICAgICAgIHRoaXMudHlwZSA9ICdzdXJmYWNlJztcbiAgICAgICAgdGhpcy5jZW50ZXIgPSBjZW50ZXI7XG4gICAgICAgIHRoaXMucmFkaXVzID0gcmFkaXVzO1xuICAgIH1cbiAgICBTcGhlcmUucHJvdG90eXBlLmdldEludGVyc2VjdERhdGEgPSBmdW5jdGlvbiAocmF5KSB7XG4gICAgICAgIHZhciBrID0gVmVjdG9yXzEuVmVjdG9yLnN1YnN0cmFjdChyYXkuZ2V0T3JpZ2luKCksIHRoaXMuY2VudGVyKSwgYiA9IFZlY3Rvcl8xLlZlY3Rvci5kb3QoaywgcmF5LmdldERpcmVjdGlvbigpKSwgYyA9IFZlY3Rvcl8xLlZlY3Rvci5kb3QoaywgaykgLSBNYXRoLnBvdyh0aGlzLnJhZGl1cywgMiksIGQgPSBNYXRoLnBvdyhiLCAyKSAtIGMsIHQxLCB0MiwgbWluVCwgbWF4VCwgaW50ZXJzZWN0aW9uUG9pbnQsIHBvaW50LCBkaXN0YW5jZTtcbiAgICAgICAgaWYgKGIgPiAwIHx8IGQgPCAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGQgPj0gMCkge1xuICAgICAgICAgICAgdDEgPSAtYiArIE1hdGguc3FydChkKTtcbiAgICAgICAgICAgIHQyID0gLWIgLSBNYXRoLnNxcnQoZCk7XG4gICAgICAgICAgICBtaW5UID0gTWF0aC5taW4odDEsIHQyKTtcbiAgICAgICAgICAgIG1heFQgPSBNYXRoLm1heCh0MSwgdDIpO1xuICAgICAgICAgICAgaWYgKG1pblQgPiBSVE1hdGhfMS5SVE1hdGguRVBTSUxPTikge1xuICAgICAgICAgICAgICAgIGludGVyc2VjdGlvblBvaW50ID0gbWluVDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGludGVyc2VjdGlvblBvaW50ID0gbWF4VDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpbnRlcnNlY3Rpb25Qb2ludCA8IFJUTWF0aF8xLlJUTWF0aC5FUFNJTE9OKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHBvaW50ID0gVmVjdG9yXzEuVmVjdG9yLmFkZChWZWN0b3JfMS5WZWN0b3Iuc2NhbGVkKHJheS5nZXREaXJlY3Rpb24oKSwgaW50ZXJzZWN0aW9uUG9pbnQpLCByYXkuZ2V0T3JpZ2luKCkpO1xuICAgICAgICBkaXN0YW5jZSA9IFZlY3Rvcl8xLlZlY3Rvci5zdWJzdHJhY3QocG9pbnQsIHJheS5nZXRPcmlnaW4oKSkuZ2V0TGVuZ3RoKCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBwb2ludDogcG9pbnQsXG4gICAgICAgICAgICBkaXN0YW5jZTogZGlzdGFuY2VcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFNwaGVyZS5wcm90b3R5cGUuZ2V0TWF0ZXJpYWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1hdGVyaWFsO1xuICAgIH07XG4gICAgU3BoZXJlLnByb3RvdHlwZS5nZXROb3JtYWwgPSBmdW5jdGlvbiAocG9pbnQpIHtcbiAgICAgICAgcmV0dXJuIFZlY3Rvcl8xLlZlY3Rvci5ub3JtYWxpemVkKFZlY3Rvcl8xLlZlY3Rvci5zY2FsZWQoVmVjdG9yXzEuVmVjdG9yLnN1YnN0cmFjdChwb2ludCwgdGhpcy5jZW50ZXIpLCAxIC8gdGhpcy5yYWRpdXMpKTtcbiAgICB9O1xuICAgIFNwaGVyZS5wcm90b3R5cGUuZ2V0VHlwZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudHlwZTtcbiAgICB9O1xuICAgIFNwaGVyZS5wcm90b3R5cGUuc2V0TWF0ZXJpYWwgPSBmdW5jdGlvbiAobWF0ZXJpYWwpIHtcbiAgICAgICAgdGhpcy5tYXRlcmlhbCA9IG1hdGVyaWFsO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIHJldHVybiBTcGhlcmU7XG59KShBYnN0cmFjdE9iamVjdF8xLkFic3RyYWN0T2JqZWN0KTtcbmV4cG9ydHMuU3BoZXJlID0gU3BoZXJlO1xuIiwiaW1wb3J0IHsgUlRNYXRoIH0gZnJvbSBcIi4uL1JUTWF0aFwiO1xuaW1wb3J0IHsgQWJzdHJhY3RPYmplY3QgfSBmcm9tIFwiLi9BYnN0cmFjdE9iamVjdFwiO1xuaW1wb3J0IHsgQ29sb3IgfSBmcm9tIFwiLi4vQ29sb3IvQ29sb3JcIjtcbmltcG9ydCB7IE1hdGVyaWFsIH0gZnJvbSBcIi4uL01hdGVyaWFsXCI7XG5pbXBvcnQgeyBSYXkgfSBmcm9tIFwiLi4vUmF5XCI7XG5pbXBvcnQgeyBSR0JDb2xvciB9IGZyb20gXCIuLi9Db2xvci9SR0JDb2xvclwiO1xuaW1wb3J0IHsgVmVjdG9yIH0gZnJvbSBcIi4uL1ZlY3RvclwiO1xuXG5leHBvcnQgY2xhc3MgU3BoZXJlIGV4dGVuZHMgQWJzdHJhY3RPYmplY3Qge1xuICAgIHByaXZhdGUgY2VudGVyOiBWZWN0b3I7XG4gICAgcHJpdmF0ZSByYWRpdXM6IG51bWJlcjtcbiAgICBwcml2YXRlIG1hdGVyaWFsOiBNYXRlcmlhbCA9IG5ldyBNYXRlcmlhbChuZXcgQ29sb3IobmV3IFJHQkNvbG9yKDI1NSwgMCwgMCkpLCAwKTtcbiAgICBwcml2YXRlIHR5cGU6IHN0cmluZyA9ICdzdXJmYWNlJztcblxuICAgIGNvbnN0cnVjdG9yIChjZW50ZXI6IFZlY3RvciwgcmFkaXVzOiBudW1iZXIpIHtcbiAgICAgICAgc3VwZXIgKCk7XG5cbiAgICAgICAgdGhpcy5jZW50ZXIgPSBjZW50ZXI7XG4gICAgICAgIHRoaXMucmFkaXVzID0gcmFkaXVzO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRJbnRlcnNlY3REYXRhIChyYXk6IFJheSk6IGFueSB7XG4gICAgICAgIGxldCBrID0gVmVjdG9yLnN1YnN0cmFjdChyYXkuZ2V0T3JpZ2luKCksIHRoaXMuY2VudGVyKSxcbiAgICAgICAgICAgIGI6IG51bWJlciA9IFZlY3Rvci5kb3QoaywgcmF5LmdldERpcmVjdGlvbigpKSxcbiAgICAgICAgICAgIGM6IG51bWJlciA9IFZlY3Rvci5kb3QoaywgaykgLSB0aGlzLnJhZGl1cyAqKiAyLFxuICAgICAgICAgICAgZDogbnVtYmVyID0gYiAqKiAyIC0gYyxcbiAgICAgICAgICAgIHQxOiBudW1iZXIsXG4gICAgICAgICAgICB0MjogbnVtYmVyLFxuICAgICAgICAgICAgbWluVDogbnVtYmVyLFxuICAgICAgICAgICAgbWF4VDogbnVtYmVyLFxuICAgICAgICAgICAgaW50ZXJzZWN0aW9uUG9pbnQ6IG51bWJlcixcbiAgICAgICAgICAgIHBvaW50OiBWZWN0b3IsXG4gICAgICAgICAgICBkaXN0YW5jZTogbnVtYmVyO1xuXG4gICAgICAgIGlmIChiID4gMCB8fCBkIDwgMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGQgPj0gMCkge1xuICAgICAgICAgICAgdDEgPSAtYiArIE1hdGguc3FydChkKTtcbiAgICAgICAgICAgIHQyID0gLWIgLSBNYXRoLnNxcnQoZCk7XG4gICAgICAgICAgICBtaW5UID0gTWF0aC5taW4odDEsIHQyKTtcbiAgICAgICAgICAgIG1heFQgPSBNYXRoLm1heCh0MSwgdDIpO1xuXG4gICAgICAgICAgICBpZiAobWluVCA+IFJUTWF0aC5FUFNJTE9OKSB7XG4gICAgICAgICAgICAgICAgaW50ZXJzZWN0aW9uUG9pbnQgPSBtaW5UO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpbnRlcnNlY3Rpb25Qb2ludCA9IG1heFQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChpbnRlcnNlY3Rpb25Qb2ludCA8IFJUTWF0aC5FUFNJTE9OKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcG9pbnQgPSBWZWN0b3IuYWRkKFxuICAgICAgICAgICAgVmVjdG9yLnNjYWxlZChyYXkuZ2V0RGlyZWN0aW9uKCksIGludGVyc2VjdGlvblBvaW50KSxcbiAgICAgICAgICAgIHJheS5nZXRPcmlnaW4oKVxuICAgICAgICApO1xuICAgICAgICBkaXN0YW5jZSA9IFZlY3Rvci5zdWJzdHJhY3QoXG4gICAgICAgICAgICBwb2ludCxcbiAgICAgICAgICAgIHJheS5nZXRPcmlnaW4oKVxuICAgICAgICApLmdldExlbmd0aCgpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBwb2ludCxcbiAgICAgICAgICAgIGRpc3RhbmNlXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcHVibGljIGdldE1hdGVyaWFsICgpOiBNYXRlcmlhbCB7XG4gICAgICAgIHJldHVybiB0aGlzLm1hdGVyaWFsO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXROb3JtYWwgKHBvaW50OiBWZWN0b3IpOiBWZWN0b3Ige1xuICAgICAgICByZXR1cm4gVmVjdG9yLm5vcm1hbGl6ZWQoXG4gICAgICAgICAgICBWZWN0b3Iuc2NhbGVkKFxuICAgICAgICAgICAgICAgIFZlY3Rvci5zdWJzdHJhY3QocG9pbnQsIHRoaXMuY2VudGVyKSxcbiAgICAgICAgICAgICAgICAxIC8gdGhpcy5yYWRpdXNcbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0VHlwZSAoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudHlwZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc2V0TWF0ZXJpYWwgKG1hdGVyaWFsOiBNYXRlcmlhbCk6IHRoaXMge1xuICAgICAgICB0aGlzLm1hdGVyaWFsID0gbWF0ZXJpYWw7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
