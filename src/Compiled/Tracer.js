var Tracer=function(){function e(e,t,r){this.currentX=0,this.currentY=0,this.emptyWorkers=[],this.numberOfWorkers=16,this.pixelsArray=[],this.screenWidth=250,this.screenHeight=250,this.ctx=e,this.screenWidth=t,this.screenHeight=r,this.screenWidth<this.numberOfWorkers&&(this.numberOfWorkers=this.screenWidth-2),this.image=e.getImageData(0,0,this.screenWidth,this.screenHeight),this.imageData=this.image.data;for(var i=0;i<this.numberOfWorkers;i++)this.emptyWorkers.push(new Worker("TracerWorker.js"));for(var s=0;s<this.screenHeight;s++)for(var a=0;a<this.screenWidth;a++)this.pixelsArray.push({x:a,y:s})}return e.prototype.createWorker=function(e,t,r){var i=this;e.onmessage=function(t){var r=t.data;return"string"==typeof r&&(r=JSON.parse(r)),i.imageData[r[1]*i.screenWidth*4+4*r[0]]=r[2],i.imageData[r[1]*i.screenWidth*4+(4*r[0]+1)]=r[3],i.imageData[r[1]*i.screenWidth*4+(4*r[0]+2)]=r[4],i.imageData[r[1]*i.screenWidth*4+(4*r[0]+3)]=255,i.emptyWorkers.push(e),0===i.pixelsArray.length&&i.emptyWorkers.length===i.numberOfWorkers?i.doneCallback():void(0!==i.pixelsArray.length&&i.pixelManager())},e.postMessage([this.screenWidth,this.screenHeight,t,r])},e.prototype.pixelManager=function(e){var t,r;e&&(this.doneCallback=e);for(var i=0,s=this.emptyWorkers.length;s>i;i++)t=this.emptyWorkers.shift(),r=this.pixelsArray.shift(),this.createWorker(t,r.x,r.y),r.x===this.screenWidth-1&&(this.image.data=this.imageData,this.ctx.putImageData(this.image,0,0))},e.prototype.run=function(){var e=this;this.startTime=new Date,this.pixelManager(function(){e.image.data=e.imageData,e.ctx.putImageData(e.image,0,0),e.endTime=new Date,console.log((e.endTime-e.startTime)/1e3+" секунд")})},e}();exports.Tracer=Tracer;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlRyYWNlci50cyJdLCJuYW1lcyI6WyJUcmFjZXIiLCJUcmFjZXIuY29uc3RydWN0b3IiLCJUcmFjZXIuY3JlYXRlV29ya2VyIiwiVHJhY2VyLnBpeGVsTWFuYWdlciIsIlRyYWNlci5ydW4iLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQSxHQUFBQSxRQUFBLFdBZUlBLFFBQUFBLEdBQWFBLEVBQStCQSxFQUFzQkEsR0FibEVDLEtBQUFBLFNBQW1CQSxFQUNuQkEsS0FBQUEsU0FBbUJBLEVBQ25CQSxLQUFBQSxnQkFJQUEsS0FBQUEsZ0JBQWtCQSxHQUNsQkEsS0FBQUEsZUFDQUEsS0FBQUEsWUFBc0JBLElBQ3RCQSxLQUFBQSxhQUF1QkEsSUFLbkJBLEtBQUtBLElBQU1BLEVBQ1hBLEtBQUtBLFlBQWNBLEVBQ25CQSxLQUFLQSxhQUFlQSxFQUVoQkEsS0FBS0EsWUFBY0EsS0FBS0Esa0JBQ3hCQSxLQUFLQSxnQkFBa0JBLEtBQUtBLFlBQWNBLEdBRzlDQSxLQUFLQSxNQUFRQSxFQUFJQSxhQUFhQSxFQUFHQSxFQUFHQSxLQUFLQSxZQUFhQSxLQUFLQSxjQUMzREEsS0FBS0EsVUFBWUEsS0FBS0EsTUFBWUEsSUFFbENBLEtBQUtBLEdBQUlBLEdBQUlBLEVBQUdBLEVBQUlBLEtBQUtBLGdCQUFpQkEsSUFDdENBLEtBQUtBLGFBQWFBLEtBQUtBLEdBQUlBLFFBQU9BLG1CQUd0Q0EsS0FBS0EsR0FBSUEsR0FBSUEsRUFBR0EsRUFBSUEsS0FBS0EsYUFBY0EsSUFDbkNBLElBQUtBLEdBQUlBLEdBQUlBLEVBQUdBLEVBQUlBLEtBQUtBLFlBQWFBLElBQ2xDQSxLQUFLQSxZQUFZQSxNQUNiQSxFQUFBQSxFQUNBQSxFQUFBQSxJQW1FcEJELE1BN0RZQSxHQUFBQSxVQUFBQSxhQUFSQSxTQUFzQkEsRUFBUUEsRUFBR0EsR0FBakNFLEdBQUFBLEdBQUFBLElBQ0lBLEdBQU9BLFVBQVlBLFNBQUNBLEdBQ2hCQSxHQUFJQSxHQUFPQSxFQUFRQSxJQWFuQkEsT0FYb0JBLGdCQUFYQSxLQUNMQSxFQUFPQSxLQUFLQSxNQUFNQSxJQUd0QkEsRUFBS0EsVUFBV0EsRUFBS0EsR0FBS0EsRUFBS0EsWUFBY0EsRUFBZ0JBLEVBQVZBLEVBQUtBLElBQVdBLEVBQUtBLEdBQ3hFQSxFQUFLQSxVQUFXQSxFQUFLQSxHQUFLQSxFQUFLQSxZQUFjQSxHQUFnQkEsRUFBVkEsRUFBS0EsR0FBU0EsSUFBTUEsRUFBS0EsR0FDNUVBLEVBQUtBLFVBQVdBLEVBQUtBLEdBQUtBLEVBQUtBLFlBQWNBLEdBQWdCQSxFQUFWQSxFQUFLQSxHQUFTQSxJQUFNQSxFQUFLQSxHQUM1RUEsRUFBS0EsVUFBV0EsRUFBS0EsR0FBS0EsRUFBS0EsWUFBY0EsR0FBZ0JBLEVBQVZBLEVBQUtBLEdBQVNBLElBQU1BLElBRXZFQSxFQUFLQSxhQUFhQSxLQUFLQSxHQUVTQSxJQUE1QkEsRUFBS0EsWUFBWUEsUUFBZ0JBLEVBQUtBLGFBQWFBLFNBQVdBLEVBQUtBLGdCQUM1REEsRUFBS0Esb0JBR2dCQSxJQUE1QkEsRUFBS0EsWUFBWUEsUUFDakJBLEVBQUtBLGlCQUliQSxFQUFPQSxhQUFhQSxLQUFLQSxZQUFhQSxLQUFLQSxhQUFjQSxFQUFHQSxLQUd4REYsRUFBQUEsVUFBQUEsYUFBUkEsU0FBc0JBLEdBQ2xCRyxHQUFJQSxHQUNBQSxDQUVBQSxLQUNBQSxLQUFLQSxhQUFlQSxFQUd4QkEsS0FBS0EsR0FBSUEsR0FBSUEsRUFBR0EsRUFBcUJBLEtBQUtBLGFBQWFBLE9BQVlBLEVBQUpBLEVBQXdCQSxJQUNuRkEsRUFBZUEsS0FBS0EsYUFBYUEsUUFDakNBLEVBQVNBLEtBQUtBLFlBQVlBLFFBSTFCQSxLQUFLQSxhQUFhQSxFQUFjQSxFQUFVQSxFQUFHQSxFQUFVQSxHQUVuREEsRUFBVUEsSUFBTUEsS0FBS0EsWUFBY0EsSUFDbkNBLEtBQUtBLE1BQVlBLEtBQUlBLEtBQUtBLFVBQzFCQSxLQUFLQSxJQUFJQSxhQUFhQSxLQUFLQSxNQUFPQSxFQUFHQSxLQUsxQ0gsRUFBQUEsVUFBQUEsSUFBUEEsV0FBQUksR0FBQUEsR0FBQUEsSUFDSUEsTUFBS0EsVUFBWUEsR0FBSUEsTUFFckJBLEtBQUtBLGFBQWFBLFdBQ2RBLEVBQUtBLE1BQVlBLEtBQUlBLEVBQUtBLFVBQzFCQSxFQUFLQSxJQUFJQSxhQUFhQSxFQUFLQSxNQUFPQSxFQUFHQSxHQUVyQ0EsRUFBS0EsUUFBVUEsR0FBSUEsTUFDbkJBLFFBQVFBLEtBQVFBLEVBQUtBLFFBQVVBLEVBQUtBLFdBQWFBLElBQUlBLGNBR2pFSixJQXRHYUssU0FBQUwsT0FBTUEiLCJmaWxlIjoiVHJhY2VyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNsYXNzIFRyYWNlciB7XG4gICAgY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQ7XG4gICAgY3VycmVudFg6IG51bWJlciA9IDA7XG4gICAgY3VycmVudFk6IG51bWJlciA9IDA7XG4gICAgZW1wdHlXb3JrZXJzID0gW107XG4gICAgZG9uZUNhbGxiYWNrOiAoKSA9PiB2b2lkO1xuICAgIGltYWdlOiBhbnk7XG4gICAgaW1hZ2VEYXRhOiBudW1iZXJbXTtcbiAgICBudW1iZXJPZldvcmtlcnMgPSAxNjtcbiAgICBwaXhlbHNBcnJheTogYW55W10gPSBbXTtcbiAgICBzY3JlZW5XaWR0aDogbnVtYmVyID0gMjUwO1xuICAgIHNjcmVlbkhlaWdodDogbnVtYmVyID0gMjUwO1xuICAgIHN0YXJ0VGltZTogYW55O1xuICAgIGVuZFRpbWU6IGFueTtcblxuICAgIGNvbnN0cnVjdG9yIChjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCwgc2NyZWVuV2lkdGg/OiBudW1iZXIsIHNjcmVlbkhlaWdodD86IG51bWJlcikge1xuICAgICAgICB0aGlzLmN0eCA9IGN0eDtcbiAgICAgICAgdGhpcy5zY3JlZW5XaWR0aCA9IHNjcmVlbldpZHRoO1xuICAgICAgICB0aGlzLnNjcmVlbkhlaWdodCA9IHNjcmVlbkhlaWdodDtcblxuICAgICAgICBpZiAodGhpcy5zY3JlZW5XaWR0aCA8IHRoaXMubnVtYmVyT2ZXb3JrZXJzKSB7XG4gICAgICAgICAgICB0aGlzLm51bWJlck9mV29ya2VycyA9IHRoaXMuc2NyZWVuV2lkdGggLSAyO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5pbWFnZSA9IGN0eC5nZXRJbWFnZURhdGEoMCwgMCwgdGhpcy5zY3JlZW5XaWR0aCwgdGhpcy5zY3JlZW5IZWlnaHQpO1xuICAgICAgICB0aGlzLmltYWdlRGF0YSA9IHRoaXMuaW1hZ2VbJ2RhdGEnXTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubnVtYmVyT2ZXb3JrZXJzOyBpKyspIHtcbiAgICAgICAgICAgIHRoaXMuZW1wdHlXb3JrZXJzLnB1c2gobmV3IFdvcmtlcignVHJhY2VyV29ya2VyLmpzJykpO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChsZXQgeSA9IDA7IHkgPCB0aGlzLnNjcmVlbkhlaWdodDsgeSsrKSB7XG4gICAgICAgICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHRoaXMuc2NyZWVuV2lkdGg7IHgrKykge1xuICAgICAgICAgICAgICAgIHRoaXMucGl4ZWxzQXJyYXkucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIHgsXG4gICAgICAgICAgICAgICAgICAgIHlcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlV29ya2VyICh3b3JrZXIsIHgsIHkpIHtcbiAgICAgICAgd29ya2VyLm9ubWVzc2FnZSA9IChtZXNzYWdlKSA9PiB7XG4gICAgICAgICAgICBsZXQgZGF0YSA9IG1lc3NhZ2UuZGF0YTtcblxuICAgICAgICAgICAgaWYodHlwZW9mKGRhdGEpID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmltYWdlRGF0YVsoZGF0YVsxXSAqIHRoaXMuc2NyZWVuV2lkdGggKiA0KSArIChkYXRhWzBdICogNCldID0gZGF0YVsyXTtcbiAgICAgICAgICAgIHRoaXMuaW1hZ2VEYXRhWyhkYXRhWzFdICogdGhpcy5zY3JlZW5XaWR0aCAqIDQpICsgKGRhdGFbMF0gKiA0ICsgMSldID0gZGF0YVszXTtcbiAgICAgICAgICAgIHRoaXMuaW1hZ2VEYXRhWyhkYXRhWzFdICogdGhpcy5zY3JlZW5XaWR0aCAqIDQpICsgKGRhdGFbMF0gKiA0ICsgMildID0gZGF0YVs0XTtcbiAgICAgICAgICAgIHRoaXMuaW1hZ2VEYXRhWyhkYXRhWzFdICogdGhpcy5zY3JlZW5XaWR0aCAqIDQpICsgKGRhdGFbMF0gKiA0ICsgMyldID0gMjU1O1xuXG4gICAgICAgICAgICB0aGlzLmVtcHR5V29ya2Vycy5wdXNoKHdvcmtlcik7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnBpeGVsc0FycmF5Lmxlbmd0aCA9PT0gMCAmJiB0aGlzLmVtcHR5V29ya2Vycy5sZW5ndGggPT09IHRoaXMubnVtYmVyT2ZXb3JrZXJzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZG9uZUNhbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnBpeGVsc0FycmF5Lmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMucGl4ZWxNYW5hZ2VyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgd29ya2VyLnBvc3RNZXNzYWdlKFt0aGlzLnNjcmVlbldpZHRoLCB0aGlzLnNjcmVlbkhlaWdodCwgeCwgeV0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgcGl4ZWxNYW5hZ2VyIChjYWxsYmFjaz86ICgpID0+IHZvaWQpIHtcbiAgICAgICAgbGV0IGFjdGl2ZVdvcmtlcixcbiAgICAgICAgICAgIHBpeGVsczogYW55W107XG5cbiAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLmRvbmVDYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChsZXQgdyA9IDAsIGVtcHR5V29ya2Vyc0xlbmd0aCA9IHRoaXMuZW1wdHlXb3JrZXJzLmxlbmd0aDsgdyA8IGVtcHR5V29ya2Vyc0xlbmd0aDsgdysrKSB7XG4gICAgICAgICAgICBhY3RpdmVXb3JrZXIgPSB0aGlzLmVtcHR5V29ya2Vycy5zaGlmdCgpO1xuICAgICAgICAgICAgcGl4ZWxzID0gdGhpcy5waXhlbHNBcnJheS5zaGlmdCgpO1xuXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhwaXhlbHNbJ3knXSwgcGl4ZWxzWyd4J10pO1xuXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZVdvcmtlcihhY3RpdmVXb3JrZXIsIHBpeGVsc1sneCddLCBwaXhlbHNbJ3knXSk7XG5cbiAgICAgICAgICAgIGlmIChwaXhlbHNbJ3gnXSA9PT0gdGhpcy5zY3JlZW5XaWR0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmltYWdlWydkYXRhJ10gPSB0aGlzLmltYWdlRGF0YTtcbiAgICAgICAgICAgICAgICB0aGlzLmN0eC5wdXRJbWFnZURhdGEodGhpcy5pbWFnZSwgMCwgMClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBydW4gKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnN0YXJ0VGltZSA9IG5ldyBEYXRlKCk7XG5cbiAgICAgICAgdGhpcy5waXhlbE1hbmFnZXIoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5pbWFnZVsnZGF0YSddID0gdGhpcy5pbWFnZURhdGE7XG4gICAgICAgICAgICB0aGlzLmN0eC5wdXRJbWFnZURhdGEodGhpcy5pbWFnZSwgMCwgMCk7XG5cbiAgICAgICAgICAgIHRoaXMuZW5kVGltZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgJHsodGhpcy5lbmRUaW1lIC0gdGhpcy5zdGFydFRpbWUpIC8gMTAwMH0g0YHQtdC60YPQvdC0YCk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
