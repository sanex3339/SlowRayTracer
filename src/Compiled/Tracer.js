var Tracer=function(){function e(e,t,r){this.currentX=0,this.currentY=0,this.emptyWorkers=[],this.numberOfWorkers=16,this.screenWidth=250,this.screenHeight=250,this.ctx=e,this.screenWidth=t,this.screenHeight=r,this.screenWidth<this.numberOfWorkers&&(this.numberOfWorkers=this.screenWidth-2),this.image=e.getImageData(0,0,t,r),this.imageData=this.image.data;for(var i=0;i<this.numberOfWorkers;i++)this.emptyWorkers.push(new Worker("TracerWorker.js"))}return e.prototype.createWorker=function(e,t,r){var i=this;e.onmessage=function(t){var r=t.data;"string"==typeof r&&(r=JSON.parse(r)),i.imageData[r[1]*i.screenWidth*4+4*r[0]]=r[2],i.imageData[r[1]*i.screenWidth*4+(4*r[0]+1)]=r[3],i.imageData[r[1]*i.screenWidth*4+(4*r[0]+2)]=r[4],i.imageData[r[1]*i.screenWidth*4+(4*r[0]+3)]=255,i.emptyWorkers.push(e),i.pixelManager(i.currentX,i.currentY)},e.postMessage([this.screenWidth,this.screenHeight,t,r])},e.prototype.pixelManager=function(e,t,r){r&&(this.doneCallback=r);for(var i=0,s=this.emptyWorkers.length;s>i;i++,e++){var a=this.emptyWorkers.shift();if(e===this.screenWidth-1&&t===this.screenHeight-1)return this.doneCallback?this.doneCallback():!1;console.log(t,e),this.createWorker(a,e,t),e===this.screenWidth-1?(this.currentX=0,this.currentY++,this.image.data=this.imageData,this.ctx.putImageData(this.image,0,0)):this.currentX++}},e.prototype.run=function(){var e=this;this.startTime=new Date,this.pixelManager(this.currentX,this.currentY,function(){e.doneCallback=null,e.image.data=e.imageData,e.ctx.putImageData(e.image,0,0),e.endTime=new Date,console.log((e.endTime-e.startTime)/1e3+" секунд")})},e}();exports.Tracer=Tracer;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlRyYWNlci50cyJdLCJuYW1lcyI6WyJUcmFjZXIiLCJUcmFjZXIuY29uc3RydWN0b3IiLCJUcmFjZXIuY3JlYXRlV29ya2VyIiwiVHJhY2VyLnBpeGVsTWFuYWdlciIsIlRyYWNlci5ydW4iLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQSxHQUFBQSxRQUFBLFdBY0lBLFFBQUFBLEdBQWFBLEVBQStCQSxFQUFzQkEsR0FabEVDLEtBQUFBLFNBQW1CQSxFQUNuQkEsS0FBQUEsU0FBbUJBLEVBQ25CQSxLQUFBQSxnQkFJQUEsS0FBQUEsZ0JBQWtCQSxHQUNsQkEsS0FBQUEsWUFBc0JBLElBQ3RCQSxLQUFBQSxhQUF1QkEsSUFLbkJBLEtBQUtBLElBQU1BLEVBQ1hBLEtBQUtBLFlBQWNBLEVBQ25CQSxLQUFLQSxhQUFlQSxFQUVoQkEsS0FBS0EsWUFBY0EsS0FBS0Esa0JBQ3hCQSxLQUFLQSxnQkFBa0JBLEtBQUtBLFlBQWNBLEdBRzlDQSxLQUFLQSxNQUFRQSxFQUFJQSxhQUFhQSxFQUFHQSxFQUFHQSxFQUFhQSxHQUNqREEsS0FBS0EsVUFBWUEsS0FBS0EsTUFBWUEsSUFFbENBLEtBQUtBLEdBQUlBLEdBQUlBLEVBQUdBLEVBQUlBLEtBQUtBLGdCQUFpQkEsSUFDdENBLEtBQUtBLGFBQWFBLEtBQUtBLEdBQUlBLFFBQU9BLG9CQW9FOUNELE1BaEVZQSxHQUFBQSxVQUFBQSxhQUFSQSxTQUFzQkEsRUFBUUEsRUFBR0EsR0FBakNFLEdBQUFBLEdBQUFBLElBQ0lBLEdBQU9BLFVBQVlBLFNBQUNBLEdBQ2hCQSxHQUFJQSxHQUFPQSxFQUFRQSxJQUVDQSxpQkFBWEEsS0FDTEEsRUFBT0EsS0FBS0EsTUFBTUEsSUFHdEJBLEVBQUtBLFVBQVdBLEVBQUtBLEdBQUtBLEVBQUtBLFlBQWNBLEVBQWdCQSxFQUFWQSxFQUFLQSxJQUFXQSxFQUFLQSxHQUN4RUEsRUFBS0EsVUFBV0EsRUFBS0EsR0FBS0EsRUFBS0EsWUFBY0EsR0FBZ0JBLEVBQVZBLEVBQUtBLEdBQVNBLElBQU1BLEVBQUtBLEdBQzVFQSxFQUFLQSxVQUFXQSxFQUFLQSxHQUFLQSxFQUFLQSxZQUFjQSxHQUFnQkEsRUFBVkEsRUFBS0EsR0FBU0EsSUFBTUEsRUFBS0EsR0FDNUVBLEVBQUtBLFVBQVdBLEVBQUtBLEdBQUtBLEVBQUtBLFlBQWNBLEdBQWdCQSxFQUFWQSxFQUFLQSxHQUFTQSxJQUFNQSxJQUV2RUEsRUFBS0EsYUFBYUEsS0FBS0EsR0FFdkJBLEVBQUtBLGFBQWFBLEVBQUtBLFNBQVVBLEVBQUtBLFdBRzFDQSxFQUFPQSxhQUFhQSxLQUFLQSxZQUFhQSxLQUFLQSxhQUFjQSxFQUFHQSxLQUd4REYsRUFBQUEsVUFBQUEsYUFBUkEsU0FBc0JBLEVBQVdBLEVBQVdBLEdBR3BDRyxJQUNBQSxLQUFLQSxhQUFlQSxFQUd4QkEsS0FBS0EsR0FBSUEsR0FBSUEsRUFBR0EsRUFBcUJBLEtBQUtBLGFBQWFBLE9BQVlBLEVBQUpBLEVBQXdCQSxJQUFLQSxJQUFLQSxDQUM3RkEsR0FBSUEsR0FBZUEsS0FBS0EsYUFBYUEsT0FFckNBLElBQUlBLElBQU1BLEtBQUtBLFlBQWNBLEdBQUtBLElBQU1BLEtBQUtBLGFBQWVBLEVBQ3hEQSxNQUFPQSxNQUFLQSxhQUFnQkEsS0FBS0EsZ0JBQWlCQSxDQUd0REEsU0FBUUEsSUFBSUEsRUFBR0EsR0FFZkEsS0FBS0EsYUFBYUEsRUFBY0EsRUFBR0EsR0FFL0JBLElBQU1BLEtBQUtBLFlBQWNBLEdBQ3pCQSxLQUFLQSxTQUFXQSxFQUNoQkEsS0FBS0EsV0FFTEEsS0FBS0EsTUFBWUEsS0FBSUEsS0FBS0EsVUFDMUJBLEtBQUtBLElBQUlBLGFBQWFBLEtBQUtBLE1BQU9BLEVBQUdBLElBRXJDQSxLQUFLQSxhQUtWSCxFQUFBQSxVQUFBQSxJQUFQQSxXQUFBSSxHQUFBQSxHQUFBQSxJQUNJQSxNQUFLQSxVQUFZQSxHQUFJQSxNQUVyQkEsS0FBS0EsYUFBYUEsS0FBS0EsU0FBVUEsS0FBS0EsU0FBVUEsV0FDNUNBLEVBQUtBLGFBQWVBLEtBRXBCQSxFQUFLQSxNQUFZQSxLQUFJQSxFQUFLQSxVQUMxQkEsRUFBS0EsSUFBSUEsYUFBYUEsRUFBS0EsTUFBT0EsRUFBR0EsR0FFckNBLEVBQUtBLFFBQVVBLEdBQUlBLE1BQ25CQSxRQUFRQSxLQUFRQSxFQUFLQSxRQUFVQSxFQUFLQSxXQUFhQSxJQUFJQSxjQUdqRUosSUEvRmFLLFNBQUFMLE9BQU1BIiwiZmlsZSI6IlRyYWNlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBUcmFjZXIge1xuICAgIGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xuICAgIGN1cnJlbnRYOiBudW1iZXIgPSAwO1xuICAgIGN1cnJlbnRZOiBudW1iZXIgPSAwO1xuICAgIGVtcHR5V29ya2VycyA9IFtdO1xuICAgIGRvbmVDYWxsYmFjazogKCkgPT4gdm9pZDtcbiAgICBpbWFnZTogYW55O1xuICAgIGltYWdlRGF0YTogbnVtYmVyW107XG4gICAgbnVtYmVyT2ZXb3JrZXJzID0gMTY7XG4gICAgc2NyZWVuV2lkdGg6IG51bWJlciA9IDI1MDtcbiAgICBzY3JlZW5IZWlnaHQ6IG51bWJlciA9IDI1MDtcbiAgICBzdGFydFRpbWU6IGFueTtcbiAgICBlbmRUaW1lOiBhbnk7XG5cbiAgICBjb25zdHJ1Y3RvciAoY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQsIHNjcmVlbldpZHRoPzogbnVtYmVyLCBzY3JlZW5IZWlnaHQ/OiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5jdHggPSBjdHg7XG4gICAgICAgIHRoaXMuc2NyZWVuV2lkdGggPSBzY3JlZW5XaWR0aDtcbiAgICAgICAgdGhpcy5zY3JlZW5IZWlnaHQgPSBzY3JlZW5IZWlnaHQ7XG5cbiAgICAgICAgaWYgKHRoaXMuc2NyZWVuV2lkdGggPCB0aGlzLm51bWJlck9mV29ya2Vycykge1xuICAgICAgICAgICAgdGhpcy5udW1iZXJPZldvcmtlcnMgPSB0aGlzLnNjcmVlbldpZHRoIC0gMjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuaW1hZ2UgPSBjdHguZ2V0SW1hZ2VEYXRhKDAsIDAsIHNjcmVlbldpZHRoLCBzY3JlZW5IZWlnaHQpO1xuICAgICAgICB0aGlzLmltYWdlRGF0YSA9IHRoaXMuaW1hZ2VbJ2RhdGEnXTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubnVtYmVyT2ZXb3JrZXJzOyBpKyspIHtcbiAgICAgICAgICAgIHRoaXMuZW1wdHlXb3JrZXJzLnB1c2gobmV3IFdvcmtlcignVHJhY2VyV29ya2VyLmpzJykpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVXb3JrZXIgKHdvcmtlciwgeCwgeSkge1xuICAgICAgICB3b3JrZXIub25tZXNzYWdlID0gKG1lc3NhZ2UpID0+IHtcbiAgICAgICAgICAgIHZhciBkYXRhID0gbWVzc2FnZS5kYXRhO1xuXG4gICAgICAgICAgICBpZih0eXBlb2YoZGF0YSkgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuaW1hZ2VEYXRhWyhkYXRhWzFdICogdGhpcy5zY3JlZW5XaWR0aCAqIDQpICsgKGRhdGFbMF0gKiA0KV0gPSBkYXRhWzJdO1xuICAgICAgICAgICAgdGhpcy5pbWFnZURhdGFbKGRhdGFbMV0gKiB0aGlzLnNjcmVlbldpZHRoICogNCkgKyAoZGF0YVswXSAqIDQgKyAxKV0gPSBkYXRhWzNdO1xuICAgICAgICAgICAgdGhpcy5pbWFnZURhdGFbKGRhdGFbMV0gKiB0aGlzLnNjcmVlbldpZHRoICogNCkgKyAoZGF0YVswXSAqIDQgKyAyKV0gPSBkYXRhWzRdO1xuICAgICAgICAgICAgdGhpcy5pbWFnZURhdGFbKGRhdGFbMV0gKiB0aGlzLnNjcmVlbldpZHRoICogNCkgKyAoZGF0YVswXSAqIDQgKyAzKV0gPSAyNTU7XG5cbiAgICAgICAgICAgIHRoaXMuZW1wdHlXb3JrZXJzLnB1c2god29ya2VyKTtcblxuICAgICAgICAgICAgdGhpcy5waXhlbE1hbmFnZXIodGhpcy5jdXJyZW50WCwgdGhpcy5jdXJyZW50WSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgd29ya2VyLnBvc3RNZXNzYWdlKFt0aGlzLnNjcmVlbldpZHRoLCB0aGlzLnNjcmVlbkhlaWdodCwgeCwgeV0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgcGl4ZWxNYW5hZ2VyICh4OiBudW1iZXIsIHk6IG51bWJlciwgY2FsbGJhY2s/OiAoKSA9PiB2b2lkKSB7XG4gICAgICAgIGxldCBzZWxmID0gdGhpcztcblxuICAgICAgICBpZiAoY2FsbGJhY2spe1xuICAgICAgICAgICAgdGhpcy5kb25lQ2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAobGV0IHcgPSAwLCBlbXB0eVdvcmtlcnNMZW5ndGggPSB0aGlzLmVtcHR5V29ya2Vycy5sZW5ndGg7IHcgPCBlbXB0eVdvcmtlcnNMZW5ndGg7IHcrKywgeCsrKSB7XG4gICAgICAgICAgICBsZXQgYWN0aXZlV29ya2VyID0gdGhpcy5lbXB0eVdvcmtlcnMuc2hpZnQoKTtcblxuICAgICAgICAgICAgaWYgKHggPT09IHRoaXMuc2NyZWVuV2lkdGggLSAxICYmIHkgPT09IHRoaXMuc2NyZWVuSGVpZ2h0IC0gMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRvbmVDYWxsYmFjayA/ICB0aGlzLmRvbmVDYWxsYmFjaygpIDogZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHksIHgpO1xuXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZVdvcmtlcihhY3RpdmVXb3JrZXIsIHgsIHkpO1xuXG4gICAgICAgICAgICBpZiAoeCA9PT0gdGhpcy5zY3JlZW5XaWR0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRYID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRZKys7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmltYWdlWydkYXRhJ10gPSB0aGlzLmltYWdlRGF0YTtcbiAgICAgICAgICAgICAgICB0aGlzLmN0eC5wdXRJbWFnZURhdGEodGhpcy5pbWFnZSwgMCwgMCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFgrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBydW4gKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnN0YXJ0VGltZSA9IG5ldyBEYXRlKCk7XG5cbiAgICAgICAgdGhpcy5waXhlbE1hbmFnZXIodGhpcy5jdXJyZW50WCwgdGhpcy5jdXJyZW50WSwgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kb25lQ2FsbGJhY2sgPSBudWxsO1xuXG4gICAgICAgICAgICB0aGlzLmltYWdlWydkYXRhJ10gPSB0aGlzLmltYWdlRGF0YTtcbiAgICAgICAgICAgIHRoaXMuY3R4LnB1dEltYWdlRGF0YSh0aGlzLmltYWdlLCAwLCAwKTtcblxuICAgICAgICAgICAgdGhpcy5lbmRUaW1lID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGAkeyh0aGlzLmVuZFRpbWUgLSB0aGlzLnN0YXJ0VGltZSkgLyAxMDAwfSDRgdC10LrRg9C90LRgKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
